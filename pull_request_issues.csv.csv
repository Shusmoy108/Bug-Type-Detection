Issue Title,Issue Description,Pull Number,Pull Description
[AMQ-7380] Upgrade to commons-pool2 2.8.0,,442,
[AMQ-7381] Upgrade to geronimo-transaction 3.1.4,,441,
[AMQ-7382] Upgrade to geronimo-jacc_1.1_spec 1.0.2,,440,
AMQ-7393 - Remove unused Selenium tests,,439,
[AMQ-7383] Upgrade to httpclient 4.5.11,,438,
[AMQ-7384] Upgrade to httpcore 4.4.13,,437,
[AMQ-7385] Upgrade to shiro 1.5.0,,436,
[AMQ-7386] Upgrade to Tomcat 9.0.30,,435,
[AMQ-7392] Upgrade to Shiro 1.5.0,,434,
[AMQ-7387] Upgrade to XBean 4.15,,433,
AMQ-7390 - Update Jetty to 9.4.26.v20200117,,432,
AMQ-7142 - Inserting Bouncy Castle Provider Early in Java Security Pr…,…ovider Chain Breaks KeyStore Loading,431,…ovider Chain Breaks KeyStore Loading
[AMQ-7389] Upgrade to jasypt 1.9.3,,430,
AMQ-7231 - Fix XSS in WebConsole,,429,
AMQ-7376 - Use correct type for collections retrieval,,428,
AMQ-7373 - Updating Jolokia,,427,
AMQ-7375 - Update Spring,,426,
AMQ-7357 - Update Pax URL,,425,
"AMQ-5503: Improve initscript, reintegrate changes",https://issues.apache.org/jira/browse/AMQ-5503,424,https://issues.apache.org/jira/browse/AMQ-5503
Stop failed timer task from breaking timers.,"Very interested to see whether this PR is considered to be useful...

At my current client, we came across the problem that for some reason (that we don't understand yet) a micro-service with a connection to the broker via the activemq-client would get in a state where every 5 seconds it would report a failure to connect to the broker with the reason being: _IllegalStateException: Timer already cancelled_.  

There are several examples on the internet of this problem occurring but I've not found an actual solution to the problem, or something that explains what the underlying cause is.

After much digging, I've come to think that the basic cause of the problem is in `java.util.Timer`.  Tasks controlled by a timer should never throw exceptions because, if they do, the timer then becomes unusable.  What I think is happening is that for some reason we have a task that is throwing an exception.  However, this exception gets masked by the behaviour of the Timer; and, then, the Timer just continues ad-infinitum with IllegalStateExceptions every five seconds.

The change I've made here is simply to put try/catch into the SchedulerTimerTask so the exception from the failed underlying task can be reported; and so that the timer does not actually break (maybe the next invocation of the underlying task will work fine if it were, for example, to be due to a connection failure or something else intermittent).

In java.util.Timer there is this code:
```
    public void run() {
        try {
            mainLoop();
        } finally {
            // Someone killed this Thread, behave as if Timer cancelled
            synchronized(queue) {
                newTasksMayBeScheduled = false;
                queue.clear();  // Eliminate obsolete references
            }
        }
    }
```

Interesting comment!  Any exception in the mainLoop() kills the Timer; note that the mainLoop() does nothing itself to catch exceptions.

This problem has been noted elsewhere, for example: https://bugs.eclipse.org/bugs/show_bug.cgi?id=394215",423,"Very interested to see whether this PR is considered to be useful...

At my current client, we came across the problem that for some reason (that we don't understand yet) a micro-service with a connection to the broker via the activemq-client would get in a state where every 5 seconds it would report a failure to connect to the broker with the reason being: _IllegalStateException: Timer already cancelled_.  

There are several examples on the internet of this problem occurring but I've not found an actual solution to the problem, or something that explains what the underlying cause is.

After much digging, I've come to think that the basic cause of the problem is in `java.util.Timer`.  Tasks controlled by a timer should never throw exceptions because, if they do, the timer then becomes unusable.  What I think is happening is that for some reason we have a task that is throwing an exception.  However, this exception gets masked by the behaviour of the Timer; and, then, the Timer just continues ad-infinitum with IllegalStateExceptions every five seconds.

The change I've made here is simply to put try/catch into the SchedulerTimerTask so the exception from the failed underlying task can be reported; and so that the timer does not actually break (maybe the next invocation of the underlying task will work fine if it were, for example, to be due to a connection failure or something else intermittent).

In java.util.Timer there is this code:
```
    public void run() {
        try {
            mainLoop();
        } finally {
            // Someone killed this Thread, behave as if Timer cancelled
            synchronized(queue) {
                newTasksMayBeScheduled = false;
                queue.clear();  // Eliminate obsolete references
            }
        }
    }
```

Interesting comment!  Any exception in the mainLoop() kills the Timer; note that the mainLoop() does nothing itself to catch exceptions.

This problem has been noted elsewhere, for example: https://bugs.eclipse.org/bugs/show_bug.cgi?id=394215"
[AMQ-7351] Update to Apache pom parent 21,,422,
AMQ-7349 - Update some javascript libraries,I tested the webconsole and the examples that were changed.,421,I tested the webconsole and the examples that were changed.
AMQ-7291 initialize writing to body not needed to set property,"Unable to write property when readOnlyProperties=false, but readOnlyBody=true",420,"Unable to write property when readOnlyProperties=false, but readOnlyBody=true"
AMQ-7348 - Update Apache Shiro,,419,
[AMQ-7329] Fix exclusion in activemq-osgi,,418,
[AMQ-7008] Add index on messages table to speed up browsing,,417,
[AMQ-7345] Upgrade to jackson-databind 2.9.10.1,,416,
[AMQ-7310] Upgrade to Tomcat API 9.0.27,,415,
[AMQ-7252] Upgrade to Velocity 2.1,,414,
[AMQ-7303] Limit trace to SecurityException in the authentication broker,,413,
[AMQ-7320] Upgrade to Jackson 2.10.1,,412,
AMQ-7339 - Fix possible XSS attack in the HttpTunnelServlet,,411,
[AMQ-7327] Use maxFrameSize to limit HTTP content length,,410,
Update owasp plugin (and enable it to run correctly),"Currently, the owasp plugin doesn't run correctly due to some system scope failures.",409,"Currently, the owasp plugin doesn't run correctly due to some system scope failures."
[AMQ-7321] Reduce the number of messages in MQTT SSL offline test to limit timing issue,,408,
[AMQ-7333] Upgrade to Camel 2.24.2,,407,
[AMQ-7332] Upgrade to ant 1.10.7,,406,
[AMQ-7331] Upgrade to commons-daemon 1.2.2,,405,
[AMQ-7324] Upgrade to commons-dbcp2 2.7.0 and commons-pool2 2.7.0,,404,
[AMQ-7330] Upgrade to Jetty 9.4.22.v20191022,,403,
[AMQ-7325] Upgrade to Derby 10.15.1.3,,402,
[AMQ-7323] Upgrade to rome 1.12.2,,401,
AMQ-7322 - Add HTTPOnly flag to the webconsole + REST API Cookies,We should add the HTTPOnly flag to the webconsole + REST API Cookies,400,We should add the HTTPOnly flag to the webconsole + REST API Cookies
AMQ-7130 Update AMQ doap,https://issues.apache.org/jira/browse/AMQ-7130 is caused by the fact that our doap JIRA link is incorrect. Once this PR is merged then https://projects.apache.org/project.html?activemq will need to be updated to point to git instead of svn.,399,https://issues.apache.org/jira/browse/AMQ-7130 is caused by the fact that our doap JIRA link is incorrect. Once this PR is merged then https://projects.apache.org/project.html?activemq will need to be updated to point to git instead of svn.
Remove out-of-bounds index comparison,,398,
"Remove unused import of ""time""","Remove unused import to give readability and an easier code maintenance 

Signed-off-by: Lucca Scarano <lucca.scarano@hotmail.com>",397,"Remove unused import to give readability and an easier code maintenance 

Signed-off-by: Lucca Scarano <lucca.scarano@hotmail.com>"
AMQ-7319 - Update Jackson to 2.9.10,,396,
AMQ-7312 virtualSelectorCacheBrokerPlugin addConsumer issue,"See details on https://issues.apache.org/jira/browse/AMQ-7312

On ""browse"" action in AMQ console, a consumer is added on related queue.
When virtualSelectorCacheBrokerPlugin is activated, ""addConsumer"" method add a 'TRUE' selector on that queue that disable previous cached selector.

Could you please merge that PR on next release ?",395,"See details on https://issues.apache.org/jira/browse/AMQ-7312

On ""browse"" action in AMQ console, a consumer is added on related queue.
When virtualSelectorCacheBrokerPlugin is activated, ""addConsumer"" method add a 'TRUE' selector on that queue that disable previous cached selector.

Could you please merge that PR on next release ?"
Improve activemq init JAVACMD auto detection,"If `JAVACMD` is set to `auto` (the default from the `env` file) and the current working directory contains a directory named `auto` (and the `auto` directory is executable, which directories normally are), the `activemq` init script will incorrectly detect the `auto` directory as the `java` binary thus leaving `JAVACMD` set to `auto` which is incorrect and will fail to execute the Java VM.

To fix this, in the second attempt to detect the `java` binary, repeat the tests for a zero-length `JAVACMD` or a `JAVACMD` equal to `auto` before testing whether `JAVACMD` does not exist or is not executable.  This is necessary because when the length of `JAVA_HOME` is zero, the first attempt to detect the location of the `java` binary will not set `JAVACMD` (so it will still be `auto` when it reaches the second auto-detection attempt, and since the `auto` directory is executable, the `[ ! -x ""$JAVACMD"" ]` test will evaluate to false).

A real-world example is running the `activemq` init script as a `systemd` service where the current working directory for the `activemq` init script ends up being the root of the file system (i.e., `/`) and an NFS automounter is being used such that `/auto` exists and is a directory (and is executable).

To reproduce the problem from a Bourne-style shell:

```
$ unset JAVA_HOME
$ which java
/usr/bin/java
$ cd /tmp
$ mkdir activemq-javacmd-auto-test
$ cd activemq-javacmd-auto-test
$ mkdir auto
$ export ACTIVEMQ_HOME=/tmp/activemq-javacmd-auto-test
$ /usr/local/bin/activemq start | grep 'INFO: Using java'
INFO: Using java 'auto'
```

The expected result is that the `INFO` line says:

```
INFO: Using java '/usr/bin/java'
```",394,"If `JAVACMD` is set to `auto` (the default from the `env` file) and the current working directory contains a directory named `auto` (and the `auto` directory is executable, which directories normally are), the `activemq` init script will incorrectly detect the `auto` directory as the `java` binary thus leaving `JAVACMD` set to `auto` which is incorrect and will fail to execute the Java VM.

To fix this, in the second attempt to detect the `java` binary, repeat the tests for a zero-length `JAVACMD` or a `JAVACMD` equal to `auto` before testing whether `JAVACMD` does not exist or is not executable.  This is necessary because when the length of `JAVA_HOME` is zero, the first attempt to detect the location of the `java` binary will not set `JAVACMD` (so it will still be `auto` when it reaches the second auto-detection attempt, and since the `auto` directory is executable, the `[ ! -x ""$JAVACMD"" ]` test will evaluate to false).

A real-world example is running the `activemq` init script as a `systemd` service where the current working directory for the `activemq` init script ends up being the root of the file system (i.e., `/`) and an NFS automounter is being used such that `/auto` exists and is a directory (and is executable).

To reproduce the problem from a Bourne-style shell:

```
$ unset JAVA_HOME
$ which java
/usr/bin/java
$ cd /tmp
$ mkdir activemq-javacmd-auto-test
$ cd activemq-javacmd-auto-test
$ mkdir auto
$ export ACTIVEMQ_HOME=/tmp/activemq-javacmd-auto-test
$ /usr/local/bin/activemq start | grep 'INFO: Using java'
INFO: Using java 'auto'
```

The expected result is that the `INFO` line says:

```
INFO: Using java '/usr/bin/java'
```"
maven-compiler-plugin 3.8.1,"Release notes about version 3.8.1:
https://blogs.apache.org/maven/entry/apache-maven-compiler-plugin-version1

Release notes about version 3.8.0:
https://blogs.apache.org/maven/entry/apache-maven-compiler-plugin-version
",393,"Release notes about version 3.8.1:
https://blogs.apache.org/maven/entry/apache-maven-compiler-plugin-version1

Release notes about version 3.8.0:
https://blogs.apache.org/maven/entry/apache-maven-compiler-plugin-version
"
AMQ-7295 - Update JTA spec,,392,
AMQ-7292 - WebConsole problem due to missing ecj jar,,391,
AMQ-7289 - Fix failing HTTP tests,,390,
AMQ-7275 - Update Commons BeanUtils,,389,
[AMQ-7249] Upgrade to Scala 2.13.0,,388,
[AMQ-7249] Upgrade to Jetty 9.4.19.v20190610,,387,
[AMQ-7249] Upgrade to Camel 2.24.1,,386,
AMQ-7271 - Update XBean,,385,
AMQ-7268 - Update Zookeeper version,,384,
[AMQ-7258] Update spring.schemas in activemq-osgi,,383,
AMQ-7266 - Update Jackson databind to 2.9.9.3,"We should update Jackson databind to 2.9.9.3. Two new CVEs are issued for 2.9.9.2 (and a bug fix in 2.9.9.3):

https://www.cvedetails.com/cve/CVE-2019-14379

https://www.cvedetails.com/cve/CVE-2019-14439",382,"We should update Jackson databind to 2.9.9.3. Two new CVEs are issued for 2.9.9.2 (and a bug fix in 2.9.9.3):

https://www.cvedetails.com/cve/CVE-2019-14379

https://www.cvedetails.com/cve/CVE-2019-14439"
[AMQ-7254] Fix OSGi headers,,381,
[AMQ-7253] Upgrade to commons-dbcp2 2.6.0 and commons-pool 2.6.2,,380,
"[AMQ-7249] jetty, scala and camel upgrades for vulnerabilities fixes",,379,
AMQ-7247 - Update maven plugin API + Pax URL versions,,378,
AMQ-7244 - Update Apache Directory + FileServer,,377,
AMQ-7259 - Update HTTPClient and replace deprecated calls,,376,
AMQ-7242 - REST Content Type fixes,,375,
"AMQ-7257 - Remove default ""secret"" password from the LDAPAuthorizationMap",It's not good security practice to use default passwords.,374,It's not good security practice to use default passwords.
AMQ-7260 - Updating Shiro plus some other minor updates,,373,
AMQ-7261 - Make ActiveMQConfiguration.loadClass private,"This is a trivial PR to make some class loading functionality private to ActiveMQConfiguration, as it's not used anywhere else.",372,"This is a trivial PR to make some class loading functionality private to ActiveMQConfiguration, as it's not used anywhere else."
AMQ-7262 - Updating Karaf + also the surefire maven plugin,,371,
AMQ-7239 - Update Jettison,,370,
AMQ-7237 - Update Spring range for Karaf,,369,
AMQ-7235 - Remove hard-coded credentials from OsgiConfiguration,,368,
AMQ-7230 - Add support for regex based certificate authentication,,367,
AMQ-7419 - Remove dependency activemq-http and activemq-stomp,"This PR moves `XStreamSupport` to `activemq-client`. 

Currently this sits in `activemq-stomp`, thus requiring the ActiveMQ HTTP client to require `activemq-stomp` module on its class path, even if the client isn't using stomp.",366,"This PR moves `XStreamSupport` to `activemq-client`. 

Currently this sits in `activemq-stomp`, thus requiring the ActiveMQ HTTP client to require `activemq-stomp` module on its class path, even if the client isn't using stomp."
AMQ-7149 Remove dependency activemq-http and activemq-stomp,"This PR moves `XStreamSupport` to `activemq-client`. 

Currently this sits in `activemq-stomp`, thus requiring the ActiveMQ HTTP client to require `activemq-stomp` module on its class path, even if the client isn't using stomp.",365,"This PR moves `XStreamSupport` to `activemq-client`. 

Currently this sits in `activemq-stomp`, thus requiring the ActiveMQ HTTP client to require `activemq-stomp` module on its class path, even if the client isn't using stomp."
AMQ-7221 - Delete Scheduled messages causes ActiveMQ create/write a u…,…nnecessary huge transaction file,364,…nnecessary huge transaction file
AMQ-7219 - ActiveMQ replays journal file on a clean/unclean shutdown …,…with transacted session + Non persistent Messages,363,…with transacted session + Non persistent Messages
AMQ-6949: SocketTimeoutException when using HTTP transport connector,"I reported and fixed AMQ-6949 roughly a year ago and have been running my fix without any issues ever since.
",362,"I reported and fixed AMQ-6949 roughly a year ago and have been running my fix without any issues ever since.
"
AMQ-7216 - Update Rome dependency,Tested Atom + RSS feeds in webconsole work after the change.,361,Tested Atom + RSS feeds in webconsole work after the change.
Switch to using a https URL in the mqtt pom,,360,
AMQ-7211 STOMP: Do not clear pending ACKs on COMMIT,"This PR first adds a test that proves the behavior is broken: c3729b0

When you run this test against master it will fail:

```
-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.activemq.transport.stomp.Stomp12Test
Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 62.016 sec <<< FAILURE! - in org.apache.activemq.transport.stomp.Stomp12Test
testClientIndividualAckPrefetchTransaction(org.apache.activemq.transport.stomp.Stomp12Test)  Time elapsed: 61.822 sec  <<< FAILURE!
java.lang.AssertionError: null
	at org.junit.Assert.fail(Assert.java:86)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.junit.Assert.assertTrue(Assert.java:52)
	at org.apache.activemq.transport.stomp.Stomp12Test.testClientIndividualAckPrefetchTransaction(Stomp12Test.java:413)


Results :

Failed tests: 
  Stomp12Test.testClientIndividualAckPrefetchTransaction:413 null

Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
```

The test output shows that it only took 4 messages to trigger this condition:

```
2019-05-20 21:54:48,710 [me-limited test] - INFO  Stomp12Test                    - Broker sent: MESSAGE
expires:0
destination:/queue/org.apache.activemq.transport.stomp.Stomp12Test.testClientIndividualAckPrefetchTransaction
JMSXUserID:system
ack:ID:eborgstrom-NW3081-55336-1558414488397-6:5
subscription:1
priority:4
message-id:ID:eborgstrom-NW3081-55336-1558414488397-5:1:-1:1:5
timestamp:1558414488648

4
2019-05-20 21:54:48,711 [0.1:55337@55324] - WARN  ProtocolConverter              - Exception occurred processing: ACK -> org.apache.activemq.transport.stomp.ProtocolException: Unexpected ACK received for message-id [null]
2019-05-20 21:54:48,712 [0.1:55337@55324] - DEBUG ProtocolConverter              - Exception detail
org.apache.activemq.transport.stomp.ProtocolException: Unexpected ACK received for message-id [null]
	at org.apache.activemq.transport.stomp.ProtocolConverter.onStompAck(ProtocolConverter.java:476)
	at org.apache.activemq.transport.stomp.ProtocolConverter.onStompCommand(ProtocolConverter.java:251)
	at org.apache.activemq.transport.stomp.StompTransportFilter.onCommand(StompTransportFilter.java:85)
	at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)
	at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:233)
	at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:215)
	at java.lang.Thread.run(Thread.java:748)
2019-05-20 21:54:48,716 [me-limited test] - INFO  Stomp12Test                    - Broker sent: ERROR
message:Unexpected ACK received for message-id [null]
content-type:text/plain

org.apache.activemq.transport.stomp.ProtocolE...d.java:748)
```

Which is the exception I reported in https://issues.apache.org/jira/browse/AMQ-7211

The fix for this (be19dcaa3) is simply to NOT clear pending ACKs on transaction COMMIT & ABORT.

Looking at the ticket referenced in the commit that added the `pedingAcks.clear()` lines (52d95ee01 / https://issues.apache.org/jira/browse/AMQ-5423) I believe that changing the `this.pedingAcks.get` to `this.pedingAcks.remove` is the real solution to the memory leak that prompted the change and that clearing the acks at the end of a transaction is not needed and incorrect behavior.

CC @tabish121 -- since you commited 52d95ee01 and worked on AMQ-5423",359,"This PR first adds a test that proves the behavior is broken: c3729b0

When you run this test against master it will fail:

```
-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.activemq.transport.stomp.Stomp12Test
Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 62.016 sec <<< FAILURE! - in org.apache.activemq.transport.stomp.Stomp12Test
testClientIndividualAckPrefetchTransaction(org.apache.activemq.transport.stomp.Stomp12Test)  Time elapsed: 61.822 sec  <<< FAILURE!
java.lang.AssertionError: null
	at org.junit.Assert.fail(Assert.java:86)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.junit.Assert.assertTrue(Assert.java:52)
	at org.apache.activemq.transport.stomp.Stomp12Test.testClientIndividualAckPrefetchTransaction(Stomp12Test.java:413)


Results :

Failed tests: 
  Stomp12Test.testClientIndividualAckPrefetchTransaction:413 null

Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
```

The test output shows that it only took 4 messages to trigger this condition:

```
2019-05-20 21:54:48,710 [me-limited test] - INFO  Stomp12Test                    - Broker sent: MESSAGE
expires:0
destination:/queue/org.apache.activemq.transport.stomp.Stomp12Test.testClientIndividualAckPrefetchTransaction
JMSXUserID:system
ack:ID:eborgstrom-NW3081-55336-1558414488397-6:5
subscription:1
priority:4
message-id:ID:eborgstrom-NW3081-55336-1558414488397-5:1:-1:1:5
timestamp:1558414488648

4
2019-05-20 21:54:48,711 [0.1:55337@55324] - WARN  ProtocolConverter              - Exception occurred processing: ACK -> org.apache.activemq.transport.stomp.ProtocolException: Unexpected ACK received for message-id [null]
2019-05-20 21:54:48,712 [0.1:55337@55324] - DEBUG ProtocolConverter              - Exception detail
org.apache.activemq.transport.stomp.ProtocolException: Unexpected ACK received for message-id [null]
	at org.apache.activemq.transport.stomp.ProtocolConverter.onStompAck(ProtocolConverter.java:476)
	at org.apache.activemq.transport.stomp.ProtocolConverter.onStompCommand(ProtocolConverter.java:251)
	at org.apache.activemq.transport.stomp.StompTransportFilter.onCommand(StompTransportFilter.java:85)
	at org.apache.activemq.transport.TransportSupport.doConsume(TransportSupport.java:83)
	at org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTransport.java:233)
	at org.apache.activemq.transport.tcp.TcpTransport.run(TcpTransport.java:215)
	at java.lang.Thread.run(Thread.java:748)
2019-05-20 21:54:48,716 [me-limited test] - INFO  Stomp12Test                    - Broker sent: ERROR
message:Unexpected ACK received for message-id [null]
content-type:text/plain

org.apache.activemq.transport.stomp.ProtocolE...d.java:748)
```

Which is the exception I reported in https://issues.apache.org/jira/browse/AMQ-7211

The fix for this (be19dcaa3) is simply to NOT clear pending ACKs on transaction COMMIT & ABORT.

Looking at the ticket referenced in the commit that added the `pedingAcks.clear()` lines (52d95ee01 / https://issues.apache.org/jira/browse/AMQ-5423) I believe that changing the `this.pedingAcks.get` to `this.pedingAcks.remove` is the real solution to the memory leak that prompted the change and that clearing the acks at the end of a transaction is not needed and incorrect behavior.

CC @tabish121 -- since you commited 52d95ee01 and worked on AMQ-5423"
AMQ-7201 added shebang to generated broker admin script,,358,
[AMQ-7199] Replace Math.Random with Random.nextDouble,"[AMQ-7199](https://issues.apache.org/jira/browse/AMQ-7199) For better control over randomness and comparatively less performance overhead, Random.nextDouble can be used instead of Math.random. Such a sample instance is showed in the attached commit. ",357,"[AMQ-7199](https://issues.apache.org/jira/browse/AMQ-7199) For better control over randomness and comparatively less performance overhead, Random.nextDouble can be used instead of Math.random. Such a sample instance is showed in the attached commit. "
AMQ-7196 - During startup ActiveMq load all the scheduleDB.data on me…,…mory causing OOM,356,…mory causing OOM
Updating Spring + Camel versions,Update the Spring + Camel versions to remove a few CVE reports.,355,Update the Spring + Camel versions to remove a few CVE reports.
The session has already been closed,"Hello, when does this happen?

Execution of JMS message listener failed, and no ErrorHandler has been set. org.springframework.jms.UncategorizedJmsException: Uncategorized exception occurred during JMS processing; nested exception is javax.jms.JMSException: The session has already been closed  at org.springframework.jms.support.JmsUtils.convertJmsAccessException(JmsUtils.java:311)  at com.ishansong.queue.client.amq.builder.impl.ConsumerMessageListenerContainerBuilder$1.onMessage(ConsumerMessageListenerContainerBuilder.java:109)  at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:736)  at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:696)  at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:674)  at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:318)  at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:257)  at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1189)  at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1179)  at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:1076)  at java.lang.Thread.run(Thread.java:745) Caused by: javax.jms.JMSException: The session has already been closed  ... 10 common frames omitted ",354,"Hello, when does this happen?

Execution of JMS message listener failed, and no ErrorHandler has been set. org.springframework.jms.UncategorizedJmsException: Uncategorized exception occurred during JMS processing; nested exception is javax.jms.JMSException: The session has already been closed  at org.springframework.jms.support.JmsUtils.convertJmsAccessException(JmsUtils.java:311)  at com.ishansong.queue.client.amq.builder.impl.ConsumerMessageListenerContainerBuilder$1.onMessage(ConsumerMessageListenerContainerBuilder.java:109)  at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:736)  at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:696)  at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:674)  at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:318)  at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:257)  at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1189)  at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1179)  at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:1076)  at java.lang.Thread.run(Thread.java:745) Caused by: javax.jms.JMSException: The session has already been closed  ... 10 common frames omitted "
AMQ-7177 - Fixing to change the method name to createSessionInternal,https://issues.apache.org/jira/browse/AMQ-7177,353,https://issues.apache.org/jira/browse/AMQ-7177
Applied fix for data writer thread dying an early death,,352,
ActiveMQMessageConsumer - do not log whole message including headers in WARN,"Message can contain large number of headers, logging them in warning drastically increases log size. ",351,"Message can contain large number of headers, logging them in warning drastically increases log size. "
AMQ-7163 - If the broker had an unclean shutdown and number of free p…,"…ages is Zero after the recovery, the next shutdown will also be 'unclean'",350,"…ages is Zero after the recovery, the next shutdown will also be 'unclean'"
AMQ-7159 - Adding a new attribute on PersistenceAdapterViewMBean to s…,…how information about Storage write latency,349,…how information about Storage write latency
close DataByteArrayOutputStream buff of WriteBatch,,348,
Use secure repository url,Should be obvious,347,Should be obvious
Modified code to not read from file every time but use last modified timestamp and cache filedata.,As per the comment given by the earlier developer the code could be optimized by checking only the modified date. Made the changes for the optimization.,346,As per the comment given by the earlier developer the code could be optimized by checking only the modified date. Made the changes for the optimization.
AMQ-7265 - Enable X-XSS-Protection + X-Content-Type-Options headers for the webc…,"…onsole.

It's good security practice to set these two headers to make XSS attacks and content sniffing attacks harder.",345,"…onsole.

It's good security practice to set these two headers to make XSS attacks and content sniffing attacks harder."
AMQ-7263 - Disable directory listing for the webconsole,"We should disable directory listing for the web console, as a good security practise.",344,"We should disable directory listing for the web console, as a good security practise."
AMQ-7143 - Temporary transaction file (PageFile) being opened and clo…,"…sed many times, leading poor performance",343,"…sed many times, leading poor performance"
Keep track of free pages during Pagefile checkpoints,,342,
Update copyright year,,341,
Upgrade Jackson to 2.9.8,We should upgrade Jackson - 2.9.6 has several security advisories against it.,340,We should upgrade Jackson - 2.9.6 has several security advisories against it.
AMQ-7138 Hardcoded paths to a karaf etc directory in a file features.xml,,339,
AMQ-7137 - Implement abort() properly in the LoginModules. Also fix a bug in Lda…,…pLoginModule relating to Logout,338,…pLoginModule relating to Logout
AMQ-7135 : do a purge before deleting the destination,"From the web console, this will do a purge of the destination before deleting.",337,"From the web console, this will do a purge of the destination before deleting."
AMQ-7132 - ActiveMQ reads lots of index pages upon startup (after a g…,…raceful or ungraceful shutdown),336,…raceful or ungraceful shutdown)
AMQ-7131: Add connectionTimeout to avoid starvation,,335,
AMQ-7125 Stomp subscribe empty destination fix,"Fix for: The Broker does not send error frame back to the client, when an empty destination is specified in a stomp subscribe frame",334,"Fix for: The Broker does not send error frame back to the client, when an empty destination is specified in a stomp subscribe frame"
AMQ-7118: fix issue where the ackMessageFileMapLocation gets written on every checkpoint," fix issue where the ackMessageFileMapLocation gets written on every checkpoint, even if it hasnt changed and include the use of the Atomic boolean.  ",327," fix issue where the ackMessageFileMapLocation gets written on every checkpoint, even if it hasnt changed and include the use of the Atomic boolean.  "
AMQ-7118: fix issue with the unchanged acknowledgement map.,"If the kahadb ack message file map has not changed, then there is no reason to write it again.  So all the kahadb store tests and activemq unit test suite pass. ",326,"If the kahadb ack message file map has not changed, then there is no reason to write it again.  So all the kahadb store tests and activemq unit test suite pass. "
AMQ-7264 - Set the secure processing feature on the TransformerFactory,It's good security practice to set the secure processing feature on TransformerFactory instances (as well).,325,It's good security practice to set the secure processing feature on TransformerFactory instances (as well).
AMQ-7112 - Show duplex network bridges in the remote broker console,,324,
Update OWasp dependency check plugin version,Update OWasp dependency check plugin version,323,Update OWasp dependency check plugin version
NO-JIRA: CronParserTest is failing in Indian StandardTime ,"For the current implementation of CronParserTest, the ""mvn clean package"" is failing for me at CronParserTest.testgetNextTimeMinutes .
I've put a  Fix to Assert the nextMinute rather than converting to  seconds.",322,"For the current implementation of CronParserTest, the ""mvn clean package"" is failing for me at CronParserTest.testgetNextTimeMinutes .
I've put a  Fix to Assert the nextMinute rather than converting to  seconds."
Enable secure processing on all DocumentBuilderFactory.newInstance(),Good security practices say that all DocumentBuilderFactory instances should enable the secure processing feature and disable doctypes to avoid XXE attacks.,321,Good security practices say that all DocumentBuilderFactory instances should enable the secure processing feature and disable doctypes to avoid XXE attacks.
[AMQ-7076] Does not define spring-legacy repository by default in Act…,"…iveMQ Karaf features repo, and let the user add it",320,"…iveMQ Karaf features repo, and let the user add it"
[AMQ-7076] Does not define spring-legacy repository by default in Act…,"…iveMQ Karaf features repo, and let the user add it",319,"…iveMQ Karaf features repo, and let the user add it"
AMQ-7107 - Make QueueBrowsingTest and UsageBlockedDispatchTest succee…,…d with ConcurrentStoreAndDispachQueues=false,318,…d with ConcurrentStoreAndDispachQueues=false
AMQ-7082 We should make sure that pages that is being recovered canno…,…t be reused,317,…t be reused
AMQ-7082 - Make sure that the recovery will only mark pages as free i…,…f they were created in a previous execution,316,…f they were created in a previous execution
AMQ-7091 - O(n) Memory consumption when broker has inactive durable s…,…ubscribes causing OOM,315,…ubscribes causing OOM
Fix missing trace argument,"LGTM.com found this mismatch between format and arguments.

Lets also make sure the array is printable.
Source: https://lgtm.com/projects/g/apache/activemq/alerts/?mode=list",314,"LGTM.com found this mismatch between format and arguments.

Lets also make sure the array is printable.
Source: https://lgtm.com/projects/g/apache/activemq/alerts/?mode=list"
AMQ-7080 - Keep track of free pages - Update db.free file during chec…,…kpoints,313,…kpoints
[AMQ-7068] Advisory messages are empty when received with a AMQP subscription,"This pull request does not tackle the whole problem, but part of it.
Maps `ConnectionInfo` and parts of `RemoveInfo` advisory messages for usage with AMQP.
",312,"This pull request does not tackle the whole problem, but part of it.
Maps `ConnectionInfo` and parts of `RemoveInfo` advisory messages for usage with AMQP.
"
[AMQ-6780] Add PostgreSQL version JDBC driver name in jdbc store services,,311,
[AMQ-7076] Fix and update features to fully support Karaf 4.2.x,,310,
[AMQ-7075] Fix Camel test (userName instead of username),,309,
[AMQ-7072] moving to JSON-B API instead of jackson,"Goal is to let users switch the impl on need + using johnzon as default
Issue was identified on TomEE where jackson is not desired in the distribution cause there is already johnzon and some 
",308,"Goal is to let users switch the impl on need + using johnzon as default
Issue was identified on TomEE where jackson is not desired in the distribution cause there is already johnzon and some 
"
[AMQ-7063] Be able to configure ActiveMQ http transport connector by providing a jetty.xml,,307,
AMQ-7070 - Priority is not being respected when the cursor cache flips,"Messages are being dispatched with wrong priority when the cache is flipped.
All messages that could get cached in the cursor are dispatched before even though massages with higher priority is in the cache.",306,"Messages are being dispatched with wrong priority when the cache is flipped.
All messages that could get cached in the cursor are dispatched before even though massages with higher priority is in the cache."
AMQ-7069 HTTP client don't handle XStream deserialization exception,,305,
Add missing log param,"Found two places, where either a placeholder or a parameter was missing.",304,"Found two places, where either a placeholder or a parameter was missing."
Use varargs for log parameters instead of `new Object[]`,"Some log statements where called with a combination of `new Object[] {...}` and
an exception. That lead to a misinterpretation of those parameters. The first
object array is considered to be the first argument and the exception the second
parameter of the format string.
It should have been interpreted as the members of the object array as the parameters
for the format string and the exception as the exception itself.

So for example:

```
  LOG.info(""User {} has done {}"", new Object[] {""A"", ""something""}, e);
```

would log something like:

```
  User [A, something] has done java.lang.RuntimeException: OOps
```",303,"Some log statements where called with a combination of `new Object[] {...}` and
an exception. That lead to a misinterpretation of those parameters. The first
object array is considered to be the first argument and the exception the second
parameter of the format string.
It should have been interpreted as the members of the object array as the parameters
for the format string and the exception as the exception itself.

So for example:

```
  LOG.info(""User {} has done {}"", new Object[] {""A"", ""something""}, e);
```

would log something like:

```
  User [A, something] has done java.lang.RuntimeException: OOps
```"
[AMQ-7067] KahaDB Recovery can experience a dangling transaction when…,"[AMQ-7067] KahaDB Recovery can experience a dangling transaction when prepare and commit occur on different pagefiles.

Test cases added for Commit and Rollback on XA and Non-XA transactions.

Executed kahadb-store tests, activemq-unit-tests, and ran full build.",302,"[AMQ-7067] KahaDB Recovery can experience a dangling transaction when prepare and commit occur on different pagefiles.

Test cases added for Commit and Rollback on XA and Non-XA transactions.

Executed kahadb-store tests, activemq-unit-tests, and ran full build."
AMQ-7056 - Fix AMQ3625Test and JaasNetworkTest Tests,"Those tests were faling due:

Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: No name matching {HOST} found
        at sun.security.ssl.Alerts.getSSLException(Alerts.java:192)
        at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1959)
        at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:302)
        at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:296)",301,"Those tests were faling due:

Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: No name matching {HOST} found
        at sun.security.ssl.Alerts.getSSLException(Alerts.java:192)
        at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1959)
        at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:302)
        at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:296)"
AMQ-7055 - Optimization on SequenceSet to prevent iterating through t…,"When the index file has a huge number of free pages and the broker is starting up (loading the index) we end up in a O(n2) loop.

This was causing the broker to use 100% cpu and not being able to start up even after a long time (as i remember we had around 3 millions free page in this case)

https://github.com/apache/activemq/blob/master/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/page/PageFile.java#L428

https://github.com/apache/activemq/blob/master/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/util/SequenceSet.java#L118

I noticed that almost all the free pages was being added to the end of the sequenceSet... So for any free page the broker had to necessity iterate through  all the Set (and after doing that for nothing add . the value to the tail).

With this small change, the broker started up in less than 5 minutes.",300,"When the index file has a huge number of free pages and the broker is starting up (loading the index) we end up in a O(n2) loop.

This was causing the broker to use 100% cpu and not being able to start up even after a long time (as i remember we had around 3 millions free page in this case)

https://github.com/apache/activemq/blob/master/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/page/PageFile.java#L428

https://github.com/apache/activemq/blob/master/activemq-kahadb-store/src/main/java/org/apache/activemq/store/kahadb/disk/util/SequenceSet.java#L118

I noticed that almost all the free pages was being added to the end of the sequenceSet... So for any free page the broker had to necessity iterate through  all the Set (and after doing that for nothing add . the value to the tail).

With this small change, the broker started up in less than 5 minutes."
[AMQ-7053] Update Jetty to version 9.2.26.v20180806,,299,
AMQ-7052 - Fix JdbcXARecoveryBrokerTest and mLevelDBXARecoveryBrokerTest tests,"Fix the following tests:

JdbcXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeRollbackOnRestart:332 expected:<0> but was:<4>

JdbcXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeCommitOnRestart:391 null

mKahaDBXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeRollbackOnRestart:332 expected:<0> but was:<4>

mKahaDBXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeCommitOnRestart:391 null

mLevelDBXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeRollbackOnRestart:332 expected:<0> but was:<4>

Those tests are failing because this feature (purge transactions after reboot) was only implemented on the KahaDBPersistenceAdapter.

Change that introduced this feature: https://github.com/apache/activemq/commit/ce7498c971b99e2515f07aab36418a1a0f19c03e

The tests are failing because the class XARecoveryBrokerTest is used to test multiples adapters that are not implementing the same feature.

Steps to reproduce:

> git checkout https://github.com/apache/activemq/tree/activemq-5.15.x
> cd activemq-unit-tests
> mvn clean install -Dtest=JdbcXARecoveryBrokerTest",298,"Fix the following tests:

JdbcXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeRollbackOnRestart:332 expected:<0> but was:<4>

JdbcXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeCommitOnRestart:391 null

mKahaDBXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeRollbackOnRestart:332 expected:<0> but was:<4>

mKahaDBXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeCommitOnRestart:391 null

mLevelDBXARecoveryBrokerTest>CombinationTestSupport.runBare:107->XARecoveryBrokerTest.testPreparedTransactionRecoveredPurgeRollbackOnRestart:332 expected:<0> but was:<4>

Those tests are failing because this feature (purge transactions after reboot) was only implemented on the KahaDBPersistenceAdapter.

Change that introduced this feature: https://github.com/apache/activemq/commit/ce7498c971b99e2515f07aab36418a1a0f19c03e

The tests are failing because the class XARecoveryBrokerTest is used to test multiples adapters that are not implementing the same feature.

Steps to reproduce:

> git checkout https://github.com/apache/activemq/tree/activemq-5.15.x
> cd activemq-unit-tests
> mvn clean install -Dtest=JdbcXARecoveryBrokerTest"
AMQ-7050: Allow alternate persistence mechanism with SubQueueSelectorCacheBrokerPlugin,"More details in [JIRA](https://issues.apache.org/jira/browse/AMQ-7050). Had a go at this by pulling out an interface for cache interactions and including default, File-based implementation that behaves just as before.

This flexibility is designed to allow future, alternative implementations such as a JDBC-based cache (e.g. for folks using JDBC persistence).

Thanks for review!",297,"More details in [JIRA](https://issues.apache.org/jira/browse/AMQ-7050). Had a go at this by pulling out an interface for cache interactions and including default, File-based implementation that behaves just as before.

This flexibility is designed to allow future, alternative implementations such as a JDBC-based cache (e.g. for folks using JDBC persistence).

Thanks for review!"
[AMQ-7032] Update Shiro to 1.2.6,,296,
AMQ-7028 - Disable concurrentStoreAndDispatchQueues for slow consumers,"Using high latency FS (as NFS) to store kahadb files and setting concurrentStoreAndDispatchQueues=true may cause poor performance for slow consumer. This happens because using this option makes activemq write the produced messages one by one to the underlying file system (this is implemented by using a SingleThread ExecutorService).

Lets say that for each write to the FS takes 10ms and the queue has slow consumers. In this case, does not matter the number of concurrent messages the producers try to send to the queue, the maximum performance we can achieve is 100 TPS. Tuning this flag off, we can see a really better performance for sending messages in parallel as those messages can be batched to the FS in a single write (the performance increases with the number of concurrent messages being sent in parallel).

Looking at Activemq code we found that there is an flag used on levelDb to detect if the queue has fast or slow consumers, and decide if it will use concurrentStoreAndDispach or not.

https://issues.apache.org/jira/browse/AMQ-3750

but this flag is not used on the KahaDb implementation.

We made a code change to receive the flag in the KahaDbStore and use it to decide if the message will be stored async or not.

We think that there is no reason to try to ""StoreAndDispatch"" if the destination has slow consumers. This only brings overhead and in case of high latency FS, really poor performance when the queue has slow consumer.

For fast consumers, this change will have no effect giving the better of the 2 options.",295,"Using high latency FS (as NFS) to store kahadb files and setting concurrentStoreAndDispatchQueues=true may cause poor performance for slow consumer. This happens because using this option makes activemq write the produced messages one by one to the underlying file system (this is implemented by using a SingleThread ExecutorService).

Lets say that for each write to the FS takes 10ms and the queue has slow consumers. In this case, does not matter the number of concurrent messages the producers try to send to the queue, the maximum performance we can achieve is 100 TPS. Tuning this flag off, we can see a really better performance for sending messages in parallel as those messages can be batched to the FS in a single write (the performance increases with the number of concurrent messages being sent in parallel).

Looking at Activemq code we found that there is an flag used on levelDb to detect if the queue has fast or slow consumers, and decide if it will use concurrentStoreAndDispach or not.

https://issues.apache.org/jira/browse/AMQ-3750

but this flag is not used on the KahaDb implementation.

We made a code change to receive the flag in the KahaDbStore and use it to decide if the message will be stored async or not.

We think that there is no reason to try to ""StoreAndDispatch"" if the destination has slow consumers. This only brings overhead and in case of high latency FS, really poor performance when the queue has slow consumer.

For fast consumers, this change will have no effect giving the better of the 2 options."
AMQ-7023,"Add build profile to execute owasp dependency check plugin on ActiveMQ build.
",294,"Add build profile to execute owasp dependency check plugin on ActiveMQ build.
"
AMQ-6996 Update Xerces to 2.12.0,,293,
[AMQ-6996] Update AMQ to use Xerces 2.12.0,,292,
[AMQ-6996] Update AMQ to use Xerces 2.12.0,Update targeted for master (5.16.x).,291,Update targeted for master (5.16.x).
AMQ-7015,Added a purgeRecoveredXATransactions property on the KahaDB adaptor to purge prepared XA messages on recovery,290,Added a purgeRecoveredXATransactions property on the KahaDB adaptor to purge prepared XA messages on recovery
AMQ-7014 Separate activemq-karaf feature from activemq feature.,,289,
Amq7013,,288,
[AMQ-7011] Override dispatch to always set dispatchAsync true,AMQ-7011 Override dispatch to always set dispatchAsync true.,287,AMQ-7011 Override dispatch to always set dispatchAsync true.
[WFLY-6597] Change org.apache.activemq.jms.pool.XaPooledConnectionFac…,"…tory#tmFromJndi parameter to Boolean for JCA validation

Without this change deploying activemq-rar-5.13.3.rar on WildFly leads to ""Invalid archive"" warning as described in WFLY-6597.",286,"…tory#tmFromJndi parameter to Boolean for JCA validation

Without this change deploying activemq-rar-5.13.3.rar on WildFly leads to ""Invalid archive"" warning as described in WFLY-6597."
[AMQ-7005] Thin client OSGI bundle,,285,
AMQ-6974 Avoid overflow errors with timestamps,"Some comparisons with timestamp values are not safe. This comparisons can trigger errors that were found in other Apache projects, e.g. KAFKA-4290. 
I changed those comparisons according to what the Java documentation recommends to help preventing such errors.",284,"Some comparisons with timestamp values are not safe. This comparisons can trigger errors that were found in other Apache projects, e.g. KAFKA-4290. 
I changed those comparisons according to what the Java documentation recommends to help preventing such errors."
AMQ-6963 Fix calling the toString() method in case of different log level.,"Avoid calling toString() method in case of different log level, because toString() could create additional objects or could read volatile variable. For example:
org.apache.activemq.ActiveMQConnection#toString (AtomicBoolean)
",283,"Avoid calling toString() method in case of different log level, because toString() could create additional objects or could read volatile variable. For example:
org.apache.activemq.ActiveMQConnection#toString (AtomicBoolean)
"
AMQ-6959,"We should not create a Throwable object (which will call fillInStackTrace() method) in case of non TRACE logging. For example if we have an INFO log level, message will no be created and logged, but a Throwable object will be created.",282,"We should not create a Throwable object (which will call fillInStackTrace() method) in case of non TRACE logging. For example if we have an INFO log level, message will no be created and logged, but a Throwable object will be created."
AMQ-6930 Expose an environment variable to allow redirect stdout/stderr to a file,"This change does not modify the default behavior, the default behavior is still to pipe stdout/stderr to /dev/null. User can specify a file using an environment variable called `ACTIVEMQ_OUT` to  redirect stdout/stderr to the file. 

This change also added and fixed some tests in `assembly/src/test/scripts/init-script-testsuite`.",281,"This change does not modify the default behavior, the default behavior is still to pipe stdout/stderr to /dev/null. User can specify a file using an environment variable called `ACTIVEMQ_OUT` to  redirect stdout/stderr to the file. 

This change also added and fixed some tests in `assembly/src/test/scripts/init-script-testsuite`."
AMQ-6908 Use WebClient in QueueBrowseQuery,"`org.apache.activemq.web.controller.SendMessage` uses `org.apache.activemq.web.WebClient`, which can be configured to use console login credential instead of system user credential (by setting the connection factory username and password to `null`). This allows seamless per-user based authorization for operations through the web console. 

`org.apache.activemq.web.QueueBrowseQuery` was not using the `org.apache.activemq.web.WebClient` so it was impossible to setup authorization on per-user basis for browsing messages of a queue through web console. 

This change migrates `org.apache.activemq.web.QueueBrowseQuery` to use `org.apache.activemq.web.WebClient`.
",280,"`org.apache.activemq.web.controller.SendMessage` uses `org.apache.activemq.web.WebClient`, which can be configured to use console login credential instead of system user credential (by setting the connection factory username and password to `null`). This allows seamless per-user based authorization for operations through the web console. 

`org.apache.activemq.web.QueueBrowseQuery` was not using the `org.apache.activemq.web.WebClient` so it was impossible to setup authorization on per-user basis for browsing messages of a queue through web console. 

This change migrates `org.apache.activemq.web.QueueBrowseQuery` to use `org.apache.activemq.web.WebClient`.
"
AMQ-6781 - The ActiveMQ Web Console doesn’t support a plus (+) sign i…,…n the ClientID. Tried escape query parameters using JSP syntax.,279,…n the ClientID. Tried escape query parameters using JSP syntax.
AMQ-6905 : Upgraded ActivationConfigProperty as per API Documentation,,278,
[AMQ-6556] Support system property proxy settings for HTTP(S) client,,277,
AMQ-6904 add overrides for ms sql,,276,
BrokerService: fix typo in field and parameter name,,275,
AMQ-6894: limit poison exception message to 1024,AMQ-6894: Limit poison exception message to 1024 to avoid IOException be encoding,274,AMQ-6894: Limit poison exception message to 1024 to avoid IOException be encoding
[AMQ-6892]: Test failing unexpectedly: CamelVMTransportRoutingTest.testSendReceiveWithCamelRouteIntercepting,"When I run the test CamelVMTransportRoutingTest.testSendReceiveWithCamelRouteIntercepting, it passes, but when I run all of the tests in activemq-camel, it fails. I am running this in Intellij.

It appears the problem is unclosed connections in some of the other tests.",273,"When I run the test CamelVMTransportRoutingTest.testSendReceiveWithCamelRouteIntercepting, it passes, but when I run all of the tests in activemq-camel, it fails. I am running this in Intellij.

It appears the problem is unclosed connections in some of the other tests."
replicated LevelDB fix and debugging output,"I know LevelDB is now deprecated, and this may not get merged because of that. I certainly don't want to become its maintainer. I had an unhealthy cluster, and did not want to try and migrate it while in that state. This is just a small change to get it healthy again after a slave encountered this error:

Unexpected session error: java.net.ProtocolException: Maximum protocol buffer length exeeded

In my case I believe this is due to having too many LevelDB log files to replicate (a separate LevelDB bug, which I intend to investigate now that this cluster is healthy again).

2 commits in this PR:

1) debugging output to track that down and make it more ... debuggable.

2) a 2-character change to increase a buffer size by 4x, to ""fix"" the problem.",272,"I know LevelDB is now deprecated, and this may not get merged because of that. I certainly don't want to become its maintainer. I had an unhealthy cluster, and did not want to try and migrate it while in that state. This is just a small change to get it healthy again after a slave encountered this error:

Unexpected session error: java.net.ProtocolException: Maximum protocol buffer length exeeded

In my case I believe this is due to having too many LevelDB log files to replicate (a separate LevelDB bug, which I intend to investigate now that this cluster is healthy again).

2 commits in this PR:

1) debugging output to track that down and make it more ... debuggable.

2) a 2-character change to increase a buffer size by 4x, to ""fix"" the problem."
Activemq 5.9,,271,
Update README.md,only test,270,only test
AMQ-6781: The ActiveMQ Web Console doesn’t support a plus (+) sign in the ClientID,The ActiveMQ Web Console doesn’t support a plus (+) sign in the ClientID,269,The ActiveMQ Web Console doesn’t support a plus (+) sign in the ClientID
AMQ-6327 - Remove System.out.println,Accidently added System.out.println in https://github.com/apache/activemq/pull/267,268,Accidently added System.out.println in https://github.com/apache/activemq/pull/267
AMQ-6327 - getNextScheduledTime() returns incorrect time when working…,… with day of month,267,… with day of month
AMQ-5669 Update Karaf feature files to add required namespace (minimal,available version),266,available version)
AMQ-5669 Update Karaf feature files to add required namespace (minimal,available version),265,available version)
AMQ-6861 Allow customisation of network bridge creation logic.,,264,
Race condition makes messages queued in the session be delivered before messages queued in consumers. #256,Create new PR to trigger CI.,263,Create new PR to trigger CI.
AMQ-6828: Improvement to python AMQP example.,"As per feedback from https://issues.apache.org/jira/browse/AMQ-6828.

All feedback appreciated.",262,"As per feedback from https://issues.apache.org/jira/browse/AMQ-6828.

All feedback appreciated."
"AMQ-3189: Postgresql with spring embedded activeMQ has ""table alread created"" exception","Please review PR for AMQ-3189: Postgresql with spring embedded activeMQ has ""table already created"" exception


When using any JDBC adapter with createTablesOnStartup=""true"" a check is performed, in the method ""messageTableAlreadyExists"" to see if the tables already exist before attempting to create them. But in case of PostgresqlJDBCAdapter, the check always returns false even if they exist because there is an case mismatch. (Tables are created in postgres in lower case by default) The result of this is that the logs are polluted with a warning message (including SQLException stack trace), every time a broker starts. ",261,"Please review PR for AMQ-3189: Postgresql with spring embedded activeMQ has ""table already created"" exception


When using any JDBC adapter with createTablesOnStartup=""true"" a check is performed, in the method ""messageTableAlreadyExists"" to see if the tables already exist before attempting to create them. But in case of PostgresqlJDBCAdapter, the check always returns false even if they exist because there is an case mismatch. (Tables are created in postgres in lower case by default) The result of this is that the logs are polluted with a warning message (including SQLException stack trace), every time a broker starts. "
AMQ-6826,"This fix adds the table-prefix to the activemq_acks_pkey. This is because for postgresql if we use table-prefix statement than Indexes are also created using table-prefix. This table-prefix is empty-string if not set so shouldn't affect normal scenario.

Output from postegre db.
activemq=# \d local_activemq_acks
             Table ""public.local_activemq_acks""
    Column     |          Type          |     Modifiers      
---------------+------------------------+--------------------
 container     | character varying(250) | not null
 sub_dest      | character varying(250) | 
 client_id     | character varying(250) | not null
 sub_name      | character varying(250) | not null
 selector      | character varying(250) | 
 last_acked_id | bigint                 | 
 priority      | bigint                 | not null default 5
 xid           | character varying(250) | 
Indexes:
    ""local_activemq_acks_pkey"" PRIMARY KEY, btree (container, client_id, sub_name)
    ""local_activemq_acks_xidx"" btree (xid)
",260,"This fix adds the table-prefix to the activemq_acks_pkey. This is because for postgresql if we use table-prefix statement than Indexes are also created using table-prefix. This table-prefix is empty-string if not set so shouldn't affect normal scenario.

Output from postegre db.
activemq=# \d local_activemq_acks
             Table ""public.local_activemq_acks""
    Column     |          Type          |     Modifiers      
---------------+------------------------+--------------------
 container     | character varying(250) | not null
 sub_dest      | character varying(250) | 
 client_id     | character varying(250) | not null
 sub_name      | character varying(250) | not null
 selector      | character varying(250) | 
 last_acked_id | bigint                 | 
 priority      | bigint                 | not null default 5
 xid           | character varying(250) | 
Indexes:
    ""local_activemq_acks_pkey"" PRIMARY KEY, btree (container, client_id, sub_name)
    ""local_activemq_acks_xidx"" btree (xid)
"
AMQ-6808: preserve destination for browsed scheduled messages,Save original destination as JMS property before overwriting it when browsing scheduled messages.,259,Save original destination as JMS property before overwriting it when browsing scheduled messages.
AMQ-6805: Add new implementation based on OSGi Declarative Services t…,…o make OSGi services available for broker configuration,258,…o make OSGi services available for broker configuration
Misc. fixes,"While testing my [SLF4J Helper](http://plugins.netbeans.org/plugin/72557/) plugin for NetBeans IDE, I found some fixes and minor improvements that can be made.",257,"While testing my [SLF4J Helper](http://plugins.netbeans.org/plugin/72557/) plugin for NetBeans IDE, I found some fixes and minor improvements that can be made."
AMQ-6775: Race condition makes messages queued in the session be delivered before messages queued in consumers.,,256,
Added new ActiveMQ Logo files,,255,
AMQ-6706 Allow for hooks before broker stop occurs,"When Camel is run embedded within ActiveMQ it's shutdown is called at the point the broker is already stopped, this can lead to data loss as there could be exchanges that have not ended.

This adds the ability to specify preStopHook(s) that can be invoked during ActiveMQ shutdown but before the broker is shutdown.

With this Camel can gracefully shutdown while the broker is still started.",254,"When Camel is run embedded within ActiveMQ it's shutdown is called at the point the broker is already stopped, this can lead to data loss as there could be exchanges that have not ended.

This adds the ability to specify preStopHook(s) that can be invoked during ActiveMQ shutdown but before the broker is shutdown.

With this Camel can gracefully shutdown while the broker is still started."
Multiple ActiveMQ Logo Submission,"Hi Community,

Milap here an engineer turned a designer. I have designed few logo which you can here. I have referred Apache foundation style guide. Would like to know your feedback.

Thanks,
Milap :)




![1](https://user-images.githubusercontent.com/5056619/27222332-756cc460-52a9-11e7-84ca-b9067a9e4526.png)
![2](https://user-images.githubusercontent.com/5056619/27222333-759588d2-52a9-11e7-94df-ae0fd6875c43.png)

![4](https://user-images.githubusercontent.com/5056619/27222334-75cd2c10-52a9-11e7-95eb-41cac706d22d.png)


![3](https://user-images.githubusercontent.com/5056619/27222523-2ccf33ea-52aa-11e7-94d3-85143bb238e2.png)
",253,"Hi Community,

Milap here an engineer turned a designer. I have designed few logo which you can here. I have referred Apache foundation style guide. Would like to know your feedback.

Thanks,
Milap :)




![1](https://user-images.githubusercontent.com/5056619/27222332-756cc460-52a9-11e7-84ca-b9067a9e4526.png)
![2](https://user-images.githubusercontent.com/5056619/27222333-759588d2-52a9-11e7-94df-ae0fd6875c43.png)

![4](https://user-images.githubusercontent.com/5056619/27222334-75cd2c10-52a9-11e7-95eb-41cac706d22d.png)


![3](https://user-images.githubusercontent.com/5056619/27222523-2ccf33ea-52aa-11e7-94d3-85143bb238e2.png)
"
ActiveMQ Logo,"Hi Community,

Milap here, Product designer from India. I have designed few options for ActiveMQ logo. I have referred Apache Foundation style guide. Please let me know your feedback. :) 

![1](https://user-images.githubusercontent.com/5056619/27179887-46e506f4-51ee-11e7-9506-7ff21aa39351.png)
![2](https://user-images.githubusercontent.com/5056619/27179888-46e522b0-51ee-11e7-810c-e654c938cc96.png)
![3](https://user-images.githubusercontent.com/5056619/27179889-46e568a6-51ee-11e7-8eac-a820f67b25c9.png)
![4](https://user-images.githubusercontent.com/5056619/27179886-46e49ec6-51ee-11e7-8554-e8e7568d2e0e.png)
",252,"Hi Community,

Milap here, Product designer from India. I have designed few options for ActiveMQ logo. I have referred Apache Foundation style guide. Please let me know your feedback. :) 

![1](https://user-images.githubusercontent.com/5056619/27179887-46e506f4-51ee-11e7-9506-7ff21aa39351.png)
![2](https://user-images.githubusercontent.com/5056619/27179888-46e522b0-51ee-11e7-810c-e654c938cc96.png)
![3](https://user-images.githubusercontent.com/5056619/27179889-46e568a6-51ee-11e7-8eac-a820f67b25c9.png)
![4](https://user-images.githubusercontent.com/5056619/27179886-46e49ec6-51ee-11e7-8554-e8e7568d2e0e.png)
"
Jason Brock multiple logo submissions,,251,
Fix STOMP header escaping when using WebSocket.,"Use wire format class to marshal frames, because method
StompFrame.format() does not escape disallowed characters in STOMP
headers and can cause invalid STOMP messages to be sent, as newline and
colon characters in headers are sent as is.",250,"Use wire format class to marshal frames, because method
StompFrame.format() does not escape disallowed characters in STOMP
headers and can cause invalid STOMP messages to be sent, as newline and
colon characters in headers are sent as is."
AMQ-6689 Logo Hex Colourful,,249,
AMQ-6689: Active Arrow A,,248,
AMQ-6689: A Arrow,A Arrow,247,A Arrow
AMQ-6689: ActiveArrow,,246,
AMQ-6689: New logo for ActiveMQ,Here's my submission.,245,Here's my submission.
AMQ-6689: Logo Maroon - Submission,,244,
AMQ-6689: Logo Maroon Lower Text - Submission,,243,
AMQ-6689: Logo Colourful Modern - Submission,,242,
Logo Maroon Lower Text - Submission,,241,
Logo Colourful Modern - Submission,,240,
Logo Maroon - Submission,,239,
add ClientIdFilterDispatchPolicy and testcase,"ClientIdFilterDispatchPolicy dispatches messages in a topic to a given client. Then the message with a ""PTP_CLIENTID"" property, can be received by a mqtt client with the same clientId.

Many developer have been insterested to use this feature:
http://blog.csdn.net/kimmking/article/details/17449019",238,"ClientIdFilterDispatchPolicy dispatches messages in a topic to a given client. Then the message with a ""PTP_CLIENTID"" property, can be received by a mqtt client with the same clientId.

Many developer have been insterested to use this feature:
http://blog.csdn.net/kimmking/article/details/17449019"
Remove unnecessary boxing / unboxing,,237,
Help ! My activemq uses cpu 100%,"even I kills activemq process, cpu is still used 100%
I used top command to found activemq root bin/works  was running , used cpu 100%
I killed its process , but it started agin , still cpu 100%
How to resolve it ? My activemq is hacked in ?

",236,"even I kills activemq process, cpu is still used 100%
I used top command to found activemq root bin/works  was running , used cpu 100%
I killed its process , but it started agin , still cpu 100%
How to resolve it ? My activemq is hacked in ?

"
AMQ-6556 Support system property proxy settings for HTTP(S) client,,235,
Activemq 5.14.x,,234,
AMQ-6556 Support system property proxy settings for HTTP(S) client,,233,
set name for primary key on create table,,232,
Add new implementations of the writeUTF8 and readUTF8 methods ,that are based on Apache Harmony code.  This also avoid some code duplication that was occurring.,231,that are based on Apache Harmony code.  This also avoid some code duplication that was occurring.
Unit test illustrating AMQ-6636.,Hope this is the right way to contribute.,230,Hope this is the right way to contribute.
Introduce method to add a single trusted package,,229,
"[AMQ-6601] AMQ with master and slave broker, shutting down slave causes a dead-lock","This PR addresses the issue https://issues.apache.org/jira/browse/AMQ-6601.

The proposed solution is to start the broker asynchronously, but only wait for its starting up if it is the master (i.e. non-slave).

Closes / fixes issue #6601.

Credit goes to @lichtin for coming up with the solution.",228,"This PR addresses the issue https://issues.apache.org/jira/browse/AMQ-6601.

The proposed solution is to start the broker asynchronously, but only wait for its starting up if it is the master (i.e. non-slave).

Closes / fixes issue #6601.

Credit goes to @lichtin for coming up with the solution."
SSL Connection leaks,There are possibilities to create a denial of service attack just by opening TCP connection to a SSL port and keep it open. ,227,There are possibilities to create a denial of service attack just by opening TCP connection to a SSL port and keep it open. 
Javadoc typo fix and cleanup,This mostly fixes the url1/url2 copy and paste problem. It uses a bit more readable property syntax and introduces a single sentence (plain text) summary for class Javadoc and adds some links.,226,This mostly fixes the url1/url2 copy and paste problem. It uses a bit more readable property syntax and introduces a single sentence (plain text) summary for class Javadoc and adds some links.
[AMQ-6586] Compilation of activemq-unit-test fails,,225,
 AMQ-6577: honour usePrefetchExtension in TopicSubscription.,"The current implementation of TopicSubscription always uses the prefetch extension feature, effectively ignoring any usePrefetchExtension option set in the configuration for the topic destination.

See: [AMQ-6577](https://issues.apache.org/jira/browse/AMQ-6577)
",224,"The current implementation of TopicSubscription always uses the prefetch extension feature, effectively ignoring any usePrefetchExtension option set in the configuration for the topic destination.

See: [AMQ-6577](https://issues.apache.org/jira/browse/AMQ-6577)
"
[AMQ-6576] Problem while installing activemq-camel with Camel 2.17.x or 2.18.x,Please backport this to 2.14.x too,223,Please backport this to 2.14.x too
[AMQ-6544] Create spring.schemas with schemas of activemq and spring,"As spring is embedded now we also need to define the spring schema mappings to make them available when being offline. Downside is that this needs to be maintained. So the better way would be to join the files from activemq-spring and spring. 
Does anyone know how to do this?
",222,"As spring is embedded now we also need to define the spring schema mappings to make them available when being offline. Downside is that this needs to be maintained. So the better way would be to join the files from activemq-spring and spring. 
Does anyone know how to do this?
"
[AMQ-6546] Big refactoring and cleanup of karaf itests,,221,
"Amq 6542 Test for ConnectionFactory from config, Minor fix in activemq-cf",,220,
[AMQ-6543] Cleanup warnings in karaf itests,,219,
[AMQ-6514] Adding test for activemq blueprint setup and xbean problem,"This pull request adds a test to create a broker using a blueprint.xml file.
This test also covers the xbean problem of the above issue as it uses a config attribute in a bean.
",218,"This pull request adds a test to create a broker using a blueprint.xml file.
This test also covers the xbean problem of the above issue as it uses a config attribute in a bean.
"
https://issues.apache.org/jira/browse/AMQ-6526 - fix <Unknown> Stomp …,…operation in ProtocolException.,217,…operation in ProtocolException.
AMQ-5344: Replace bundles with feature,,216,
[AMQ-6515] Adding javax.inject bundle to fix the issue on feature ins…,…tall,215,…tall
[AMQ-6514] Upgrade xbean-blueprint to 4.2 to fix issue with placeholders,,214,
AMQ-5247: Make jmxUseLocal global settable,,213,
AMQ-6506: Increase OSGi version range for package import javax.jms,,212,
AMQ-6057: Add performance patch to JDBC statements definition,,211,
AMQ-6452: Upgrade dependency of geronimo-transaction,,210,
AMQ-6497 Add method to navigate interceptors,,209,
AMQ-6494 Process SHUTDOWN_INFO and REMOVE_INFO to avoid timeouts,"More details regarding this bug in jira.

https://issues.apache.org/jira/browse/AMQ-6494",208,"More details regarding this bug in jira.

https://issues.apache.org/jira/browse/AMQ-6494"
https://issues.apache.org/jira/browse/AMQ-6489,Add support for SSL configurations using JNDI.,207,Add support for SSL configurations using JNDI.
Add missing runlevels to Default-Start,"According to the manual (and the `runlevel` command), Debian starts in runlevel 2 by default:
https://www.debian.org/doc/manuals/debian-reference/ch03.en.html#_sysv_style_init

So in order for ActiveMQ to start up when a Debian VM starts, you have to add it to these runlevels.

Workaround: `insserv -v activemq,start=2`

Side-effects:
RedHat doesn't use runlevels 2 and 4, so it should be fine:
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/3/html/Reference_Guide/s1-boot-init-shutdown-sysv.html

SLES doesn't use runlevel 4, but it does use runlevel 2 for ""Local multiuser mode without remote network (NFS, etc.)"":
https://www.suse.com/documentation/sles11/book_sle_admin/data/sec_boot_init.html

So the only side-effect on these systems is that SLES will try to run ActiveMQ in Local multiuser mode without remote network (and probably fail).
I think that is an acceptable side-effect since people booting Debian into runlevel 2 is a _lot_ more common due to it being the default.
",206,"According to the manual (and the `runlevel` command), Debian starts in runlevel 2 by default:
https://www.debian.org/doc/manuals/debian-reference/ch03.en.html#_sysv_style_init

So in order for ActiveMQ to start up when a Debian VM starts, you have to add it to these runlevels.

Workaround: `insserv -v activemq,start=2`

Side-effects:
RedHat doesn't use runlevels 2 and 4, so it should be fine:
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/3/html/Reference_Guide/s1-boot-init-shutdown-sysv.html

SLES doesn't use runlevel 4, but it does use runlevel 2 for ""Local multiuser mode without remote network (NFS, etc.)"":
https://www.suse.com/documentation/sles11/book_sle_admin/data/sec_boot_init.html

So the only side-effect on these systems is that SLES will try to run ActiveMQ in Local multiuser mode without remote network (and probably fail).
I think that is an acceptable side-effect since people booting Debian into runlevel 2 is a _lot_ more common due to it being the default.
"
Master,"Learning
",205,"Learning
"
Setting TmpDataDirectory for setTempDataStore Method,"Related to Improvement AMQ-6403,
tmpDataDirectory value is not set
",204,"Related to Improvement AMQ-6403,
tmpDataDirectory value is not set
"
fix a wrong word,"the wrong word in this sentence ""with Hadoop based file systems to achive HA of your stored messages"" .
“achive” change to ""achieve"".
",203,"the wrong word in this sentence ""with Hadoop based file systems to achive HA of your stored messages"" .
“achive” change to ""achieve"".
"
Fixes AMQ-6441 where a negative value can be returned with large AWS EFS files systems when calling java.io.File.getTotalSpace(),"Fixes AMQ-6441

A test, testLargeFileSystem(), was added to org.apache.activemq.broker.BrokerServiceTest for checking if the total space on a volume was too large to fit into a primitive long.  If this happens, then totalSpace is set to java.lang.Long.MAX_VALUE.
",202,"Fixes AMQ-6441

A test, testLargeFileSystem(), was added to org.apache.activemq.broker.BrokerServiceTest for checking if the total space on a volume was too large to fit into a primitive long.  If this happens, then totalSpace is set to java.lang.Long.MAX_VALUE.
"
Activemq 5.6,,201,
https://issues.apache.org/jira/browse/AMQ-6442,"Config file org.apache.activemq.server-default.cfg points config to ${karaf.base}/etc
",200,"Config file org.apache.activemq.server-default.cfg points config to ${karaf.base}/etc
"
Make start script work on busybox,"The current version of the activemq start script uses options to ps which are unavailable 
in busybox.

Suggested change refactors the start script to remove duplicated code to find a java process 
given a pidfile and makes it work on busybox.

I have limited possibilities of verifying the change on different platforms but it is confirmed to
work on at least Mac OS X in addition to busybox and should work on platforms where 
previous ""ps -p"" command worked.
",199,"The current version of the activemq start script uses options to ps which are unavailable 
in busybox.

Suggested change refactors the start script to remove duplicated code to find a java process 
given a pidfile and makes it work on busybox.

I have limited possibilities of verifying the change on different platforms but it is confirmed to
work on at least Mac OS X in addition to busybox and should work on platforms where 
previous ""ps -p"" command worked.
"
AMQ-6428 - Add methods to EmbeddedActiveMQBroker an ActiveMQ client JUnit Rules,,198,
https://issues.apache.org/jira/browse/AMQ-6391,"Test case for multiple connections participating in one phase commit,
causing leak in ConnectionStateTracker.

Keep all the connections participating in an transaction in a static multimap
similar to the one in TransactionContext.

Even though Garry  says that static fields may cause issues in OSGi, I am offering this as a solution. This static map has same lifecycle, classloading and  source bundle as the one already present in TransactionContext, therefore I assume it cannot really make things worse.
",197,"Test case for multiple connections participating in one phase commit,
causing leak in ConnectionStateTracker.

Keep all the connections participating in an transaction in a static multimap
similar to the one in TransactionContext.

Even though Garry  says that static fields may cause issues in OSGi, I am offering this as a solution. This static map has same lifecycle, classloading and  source bundle as the one already present in TransactionContext, therefore I assume it cannot really make things worse.
"
Fixes CAMEL-10226: camel-jms ignores connection pool settings in spri…,"…ng-boot deployment.
",196,"…ng-boot deployment.
"
Activemq 5.11.x,,195,
Renamed README file.  Updated link for encryption and location of LICENSE.,"Formatting looks better IMHO, if you want to take a look: https://github.com/johnament/activemq/blob/master/README.md
",194,"Formatting looks better IMHO, if you want to take a look: https://github.com/johnament/activemq/blob/master/README.md
"
[AMQ-6380] Create pooled ConnectionFactories from configs in OSGi,,193,
"AMQ-6379 - Add openwire properties for provider name, provider version, and platform details",,192,
[AMQ-6355] Provide bundles for client and jms-pool,,191,
Amq 6317 create schema statements,,190,
AMQ-6317,,189,
AMQ-6310 added a check to ensure the leading wildcards in prefixes are handled correctly.,"Checking for leading wildcard in the prefix for a virtualtopic, modifying the behavior of shouldDispatch in the VirtualTopicInterceptor.
",188,"Checking for leading wildcard in the prefix for a virtualtopic, modifying the behavior of shouldDispatch in the VirtualTopicInterceptor.
"
AMQ-6301: Changed activemq-osgi so that it embeds the spring-dm bundles,"This changes the activemq-osgi bundle so that it inline-embeds the spring-dm bundles which have been used inside the ActiveMQServiceFactory since version 5.13.0.

To write tests for this, I had to hardcode the Spring versions so that they match the version from the particular version of Karaf that is used by Pax Exam. If somebody has a way to fetch these versions dynamically, that would make it easier to maintain.

If this could also be merged for inclusion in version 5.13.x, that would be appreciated! Thanks.
",187,"This changes the activemq-osgi bundle so that it inline-embeds the spring-dm bundles which have been used inside the ActiveMQServiceFactory since version 5.13.0.

To write tests for this, I had to hardcode the Spring versions so that they match the version from the particular version of Karaf that is used by Pax Exam. If somebody has a way to fetch these versions dynamically, that would make it easier to maintain.

If this could also be merged for inclusion in version 5.13.x, that would be appreciated! Thanks.
"
AMQ-6298: Fixed Spring Import-Package wildcard,"The org.springframework wildcard is above the Spring-DM org.springframework.osgi import, causing incorrect OSGi metadata.

https://issues.apache.org/jira/browse/AMQ-6298
",186,"The org.springframework wildcard is above the Spring-DM org.springframework.osgi import, causing incorrect OSGi metadata.

https://issues.apache.org/jira/browse/AMQ-6298
"
Activemq 5.12.x,,185,
AMQ-6274 - add support for message metadata - originalDestination is f…,"…irst
",184,"…irst
"
https://issues.apache.org/jira/browse/AMQ-6271,"activemq-osgi defines wrong range for org.springframework.osgi...
",183,"activemq-osgi defines wrong range for org.springframework.osgi...
"
https://issues.apache.org/jira/browse/AMQ-6271,"activemq-osgi defines wrong range for org.springframework.osgi...
",182,"activemq-osgi defines wrong range for org.springframework.osgi...
"
AMQ-6262 - HTTP transport broken in 5.12,,181,
Updating help text properly,,180,
Fix error message typo.,"Fix typo from javax.jmx.ConnectionFactory to javax.jms.ConnectionFactory
",179,"Fix typo from javax.jmx.ConnectionFactory to javax.jms.ConnectionFactory
"
Activemq 5.5,"ee
",178,"ee
"
https://issues.apache.org/jira/browse/AMQ-6244,"Fix and test for https://issues.apache.org/jira/browse/AMQ-6244
",177,"Fix and test for https://issues.apache.org/jira/browse/AMQ-6244
"
AMQ-5662 improve Web Console to support retry from all configured DLQs,"ActiveMQ Dead letter queues are defined in runtime by individual or shared DLQ strategy. However, in the web console, the retry command is only active if a queue starts with ""DLQ."" or ""DLT."". More, it does not really do a retry, only a move from DLQ.<queuename> to <queuename>. This is not correct, since a DLQ strategy might use other prefix/suffix to name a DLQ. The correct original destination is taken from a property of the message, not derived from the DLQ queue name.

This PR enables the retry command on configured DLQs, regardless of name. By some reason the default ActiveMQ.DLQ is not detected as a DLQ (looking at JMX properties of the queue), so this particular queue is also included to show the retry command. The retry command actually triggers the retry JMX operation.

This PR is actually more or less a duplicate of PR #73, but up to date with the rest of AMQ, hence pr #73 is closed.
",176,"ActiveMQ Dead letter queues are defined in runtime by individual or shared DLQ strategy. However, in the web console, the retry command is only active if a queue starts with ""DLQ."" or ""DLT."". More, it does not really do a retry, only a move from DLQ.<queuename> to <queuename>. This is not correct, since a DLQ strategy might use other prefix/suffix to name a DLQ. The correct original destination is taken from a property of the message, not derived from the DLQ queue name.

This PR enables the retry command on configured DLQs, regardless of name. By some reason the default ActiveMQ.DLQ is not detected as a DLQ (looking at JMX properties of the queue), so this particular queue is also included to show the retry command. The retry command actually triggers the retry JMX operation.

This PR is actually more or less a duplicate of PR #73, but up to date with the rest of AMQ, hence pr #73 is closed.
"
https://issues.apache.org/jira/browse/AMQ-6210,"Do not store selector information of temporary destinations.

Since the selector information is not cleared after the destination is removed, the cache grows with every temporary destinations, and a use case where a consumer would ever reconnect to a temporary queue for reception is hard to imagine.
",175,"Do not store selector information of temporary destinations.

Since the selector information is not cleared after the destination is removed, the cache grows with every temporary destinations, and a use case where a consumer would ever reconnect to a temporary queue for reception is hard to imagine.
"
https://issues.apache.org/jira/browse/AMQ-6209,"SubQueueSelectorCacheBroker should ignore selectors of network subscriptions and queue browsers, as these shouldn't permanently extend the number of matching messages of a consumer queue.
",174,"SubQueueSelectorCacheBroker should ignore selectors of network subscriptions and queue browsers, as these shouldn't permanently extend the number of matching messages of a consumer queue.
"
Update activemq.bat,"Added quotes so that when the path is expanded if there is a space in the path it will not see the path as two words, but one word
",173,"Added quotes so that when the path is expanded if there is a space in the path it will not see the path as two words, but one word
"
Move directory variables up,"Setting ACTIVEMQ_CONF to a different value and not moving it up will result in login.config being taken from the old location.
This commit fixes this by moving these variables above all places they are used in.

Fixes AMQ-6189
https://issues.apache.org/jira/browse/AMQ-6189
",172,"Setting ACTIVEMQ_CONF to a different value and not moving it up will result in login.config being taken from the old location.
This commit fixes this by moving these variables above all places they are used in.

Fixes AMQ-6189
https://issues.apache.org/jira/browse/AMQ-6189
"
Delete redundant persistenceAdapter.getTransactionContext,,171,
https://issues.apache.org/jira/browse/AMQ-6188 - reset BaseDestinatio…,"Fix and test for https://issues.apache.org/jira/browse/AMQ-6188
",170,"Fix and test for https://issues.apache.org/jira/browse/AMQ-6188
"
https://issues.apache.org/jira/browse/AMQ-6181 - Upgrade to Joda-time 2.9,"Hi,

This PR is related to:
https://issues.apache.org/jira/browse/AMQ-6181

Thanks
Andrea
",169,"Hi,

This PR is related to:
https://issues.apache.org/jira/browse/AMQ-6181

Thanks
Andrea
"
[AMQ-6165] Python stompest tests do not work with newer releases,,168,
[AMQ-6160] fix NPE; use messageId.getFutureOrSequenceLong() as sequen…,"…ceId if entryLocator is NULL
",167,"…ceId if entryLocator is NULL
"
Fix AMQ-6150 (Found 3 instances of impossible casts in the activemq code),"Running static analysis on activemq I was able to identify 3 instances of impossible casts in the code. This pull request resolves them.
",166,"Running static analysis on activemq I was able to identify 3 instances of impossible casts in the code. This pull request resolves them.
"
AMQ-6135 ActiveMQ HTTP module should support Openwire serialisation,"I am submitting this on behalf of Atlassian, the appropriate CCLAs are in place.

We have that code running in production and we didn't have any problems reports.
I assumed rather strict backward compatibility and interoperability requirements, not sure if that's needed.  Well, at least the interoperability should be there.
In any case, it's easier to have them removed than to implement them as an afterthought.
",165,"I am submitting this on behalf of Atlassian, the appropriate CCLAs are in place.

We have that code running in production and we didn't have any problems reports.
I assumed rather strict backward compatibility and interoperability requirements, not sure if that's needed.  Well, at least the interoperability should be there.
In any case, it's easier to have them removed than to implement them as an afterthought.
"
AMQ-6052 Network of brokers on duplex mode reports InstanceAlreadyExistsException on already existing destinations,"This PR is related to Issue AMQ-6052
https://issues.apache.org/jira/browse/AMQ-6052
",164,"This PR is related to Issue AMQ-6052
https://issues.apache.org/jira/browse/AMQ-6052
"
AMQ-6106 - JUnit Rule for embedded ActiveMQ Broker,,163,
https://issues.apache.org/jira/browse/AMQ-6071 - Log info about corru…,"…pted journal records at WARN level
",162,"…pted journal records at WARN level
"
Support for Openwire serialisation in HTTP,,161,
TransportConnection does not synchronize iteration on synchronized list,"In TransportConnection.java:861, the synchronized list returned by cs.getTempDestinations() is iterated
in an unsynchronized manner, but according to the [Oracle Java 7 API specification](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29),
this is not thread-safe and can lead to non-deterministic behavior. This pull request adds a fix by synchronizing the iteration on the list returned by cs.getTempDestinations().
",160,"In TransportConnection.java:861, the synchronized list returned by cs.getTempDestinations() is iterated
in an unsynchronized manner, but according to the [Oracle Java 7 API specification](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29),
this is not thread-safe and can lead to non-deterministic behavior. This pull request adds a fix by synchronizing the iteration on the list returned by cs.getTempDestinations().
"
AMQ-6058 added a check to make sure the destination starts with the v…,"…irtual topic prefix.
",159,"…irtual topic prefix.
"
release the connection even if broker communication fails,,158,
enforce connection thread releasing,"When a connection is closed the broker can be shutdown or the communication can fail.

This shouldnt prevent the connection to close and in particular to shutdown the started Session Task thread.
",157,"When a connection is closed the broker can be shutdown or the communication can fail.

This shouldnt prevent the connection to close and in particular to shutdown the started Session Task thread.
"
AMQ-6036: Parsing message selector for wildcard matches,"Parsing message selector for wildcard matches for ignoreWildcardSelectors feature.

https://issues.apache.org/jira/browse/AMQ-6036
",156,"Parsing message selector for wildcard matches for ignoreWildcardSelectors feature.

https://issues.apache.org/jira/browse/AMQ-6036
"
https://issues.apache.org/jira/browse/AMQ-6023 - Update Snappy to ver…,"…sion 1.1.2

This PR is related to:

https://issues.apache.org/jira/browse/AMQ-6023

Andrea
",155,"…sion 1.1.2

This PR is related to:

https://issues.apache.org/jira/browse/AMQ-6023

Andrea
"
https://issues.apache.org/jira/browse/AMQ-6022 - Update Netty to vers…,"…ion 4.0.32.Final

Hi all,

This PR is related to:
https://issues.apache.org/jira/browse/AMQ-6022

Andrea
",154,"…ion 4.0.32.Final

Hi all,

This PR is related to:
https://issues.apache.org/jira/browse/AMQ-6022

Andrea
"
[AMQ-6020] Adding the necessary import and removing the export packages,,153,
[AMQ-6018] Web console should not export any OSGi packages,,152,
https://issues.apache.org/jira/browse/AMQ-6003 - Upgrade Pax runner t…,"…o version 1.8.6

This PR is related to:

https://issues.apache.org/jira/browse/AMQ-6003

Andrea
",151,"…o version 1.8.6

This PR is related to:

https://issues.apache.org/jira/browse/AMQ-6003

Andrea
"
AMQ-5931 Updated jodatime to 2.8.2,"https://issues.apache.org/jira/browse/AMQ-5931
",150,"https://issues.apache.org/jira/browse/AMQ-5931
"
AMQ-5931 - Updated jodatime to 2.8.2,"https://issues.apache.org/jira/browse/AMQ-5931
",149,"https://issues.apache.org/jira/browse/AMQ-5931
"
https://issues.apache.org/jira/browse/AMQ-5998 - Upgrade Pax-url to v…,"…ersion 2.4.3

This PR is related to 

https://issues.apache.org/jira/browse/AMQ-5998

Andrea
",148,"…ersion 2.4.3

This PR is related to 

https://issues.apache.org/jira/browse/AMQ-5998

Andrea
"
https://issues.apache.org/jira/browse/AMQ-5982,"Updating netty to version 4.0.31
",147,"Updating netty to version 4.0.31
"
AMQ-5977: Add LSB headers to init script,"Add LSB headers to init script to fix problems when setting up ActiveMQ
as a daemon with chkconfig on RHEL and clones.

See: https://issues.apache.org/jira/browse/AMQ-5977

Signed-off-by: Gregor Zurowski gregor@zurowski.org
",146,"Add LSB headers to init script to fix problems when setting up ActiveMQ
as a daemon with chkconfig on RHEL and clones.

See: https://issues.apache.org/jira/browse/AMQ-5977

Signed-off-by: Gregor Zurowski gregor@zurowski.org
"
AMQ-5977: Add LSB headers to ínit script,"Add LSB headers to init script to fix problems when setting up ActiveMQ
as a daemon with chkconfig on RHEL and clones.

Signed-off-by: Gregor Zurowski gregor@zurowski.org
",145,"Add LSB headers to init script to fix problems when setting up ActiveMQ
as a daemon with chkconfig on RHEL and clones.

Signed-off-by: Gregor Zurowski gregor@zurowski.org
"
AMQ-5976: add simple queue filter for admin webapp,"https://issues.apache.org/jira/browse/AMQ-5976
",144,"https://issues.apache.org/jira/browse/AMQ-5976
"
https://issues.apache.org/jira/browse/AMQ-5961,"Prevent deadlock by moving calls to afterCommit and afterRollback out of synchronized blocks.
Same commit as before, moved it to separate branch.
",143,"Prevent deadlock by moving calls to afterCommit and afterRollback out of synchronized blocks.
Same commit as before, moved it to separate branch.
"
"Changed Readme from txt to rst, links added",,142,
https://issues.apache.org/jira/browse/AMQ-5961,"Prevent deadlock by moving calls to afterCommit
and afterRollback out of synchronized blocks.
",141,"Prevent deadlock by moving calls to afterCommit
and afterRollback out of synchronized blocks.
"
fix for AMQ-5939,"See https://issues.apache.org/jira/browse/AMQ-5939
",140,"See https://issues.apache.org/jira/browse/AMQ-5939
"
AMQ-5861: Unable to create connection factory using jms:create,"This is a patch for 5.12.x. Please see https://issues.apache.org/jira/browse/AMQ-5861 for details. Please merge this change to master as well.
",139,"This is a patch for 5.12.x. Please see https://issues.apache.org/jira/browse/AMQ-5861 for details. Please merge this change to master as well.
"
AMQ-5908 - Added sleep for receive delay to receiveAsyncCountBasedMessages().,,138,
AMQ-5903 - add patch that fixes the broker camel component ,"AMQ-5903 - add patch that fixes the broker camel component to take all header values
",137,"AMQ-5903 - add patch that fixes the broker camel component to take all header values
"
https://issues.apache.org/jira/browse/AMQ-5875,"Reworking DurableConduitBridge to look up subscriptions from the
msesage store instead of the RegionBroker since inactive subscriptions
need to be looked at as well when dynamicOnly is false for a
network bridge.
",136,"Reworking DurableConduitBridge to look up subscriptions from the
msesage store instead of the RegionBroker since inactive subscriptions
need to be looked at as well when dynamicOnly is false for a
network bridge.
"
https://issues.apache.org/jira/browse/AMQ-5879,"Adding full exception to logs for tansport failures when the exception
is unexpected to help debugging.
",135,"Adding full exception to logs for tansport failures when the exception
is unexpected to help debugging.
"
https://issues.apache.org/jira/browse/AMQ-5857,"Changing ActiveMQTextMessage to clear out the text field on marshal to
a ByteSequence to prevent the data from being stored in memory twice.
",134,"Changing ActiveMQTextMessage to clear out the text field on marshal to
a ByteSequence to prevent the data from being stored in memory twice.
"
Upgrade Jackson to version 2.5.4,"Hi,

This PR upgrades Jackson to version 2.5.4

Andrea
",133,"Hi,

This PR upgrades Jackson to version 2.5.4

Andrea
"
https://issues.apache.org/jira/browse/AMQ-5875,"Fixing a regression that caused a network bridge to recreate durable
demand improperly.
",132,"Fixing a regression that caused a network bridge to recreate durable
demand improperly.
"
https://issues.apache.org/jira/browse/AMQ-5875,"Fixing a regression that caused a network bridge to recreate durable
demand improperly.
",131,"Fixing a regression that caused a network bridge to recreate durable
demand improperly.
"
https://issues.apache.org/jira/browse/AMQ-5875,"Resolves an issue when using mKahaDB that caused a MessageStore
being used by more than one destination to be deleted even though
there was still at least 1 other destination using the store.
",130,"Resolves an issue when using mKahaDB that caused a MessageStore
being used by more than one destination to be deleted even though
there was still at least 1 other destination using the store.
"
https://issues.apache.org/jira/browse/AMQ-5748,"Fixing an issue that prevented old versions of KahaDB from being
upgraded to the newest version 6
",129,"Fixing an issue that prevented old versions of KahaDB from being
upgraded to the newest version 6
"
https://issues.apache.org/jira/browse/AMQ-5748,"Fixing a potential Null pointer exception in  MemoryMessageStore
",128,"Fixing a potential Null pointer exception in  MemoryMessageStore
"
https://issues.apache.org/jira/browse/AMQ-5340,"A QueueBrowser no longer checks expiry on messages to prevent a
browser from hanging in between the hasMoreElements check and actually
getting a message.  This means that if messages were in the queue when
the browser started it will receive messages even if they are now
expired. Even though the browser will get the expired message, the
broker will still expire it to prevent future access to it.
",127,"A QueueBrowser no longer checks expiry on messages to prevent a
browser from hanging in between the hasMoreElements check and actually
getting a message.  This means that if messages were in the queue when
the browser started it will receive messages even if they are now
expired. Even though the browser will get the expired message, the
broker will still expire it to prevent future access to it.
"
Fix class loading issues for SSL/nonSSL connectors,"- This resolves issues loading SSL and nonSSL RAR connectors in Glassfish 3.x
- proposed fix for AMQ-5873
",126,"- This resolves issues loading SSL and nonSSL RAR connectors in Glassfish 3.x
- proposed fix for AMQ-5873
"
https://issues.apache.org/jira/browse/AMQ-5814,"This fixes an issue where a producer's connection context was being
used to create a subscription instead of the consumer's context
which could lead to permission check failures.

Thanks to hongphu8790@gmail.com for providing the test case.
",125,"This fixes an issue where a producer's connection context was being
used to create a subscription instead of the consumer's context
which could lead to permission check failures.

Thanks to hongphu8790@gmail.com for providing the test case.
"
https://issues.apache.org/jira/browse/AMQ-5865,"StompSocket and MQTTSocket will now return the appropriate web socket
remote address based on the HttpRequestServlet that initialized
the web socket connection.
",124,"StompSocket and MQTTSocket will now return the appropriate web socket
remote address based on the HttpRequestServlet that initialized
the web socket connection.
"
https://issues.apache.org/jira/browse/AMQ-5851,"This commit resolves an issue where unmatched acknowledgement
messages could be received when running a MDB consumer and
sending messages with a short TTL.  The expiration logic when
receiveing an expired Message Ack will now only expire messages
in dispatch relating to the received ack, not all expired messages
in the dispatch list.
",123,"This commit resolves an issue where unmatched acknowledgement
messages could be received when running a MDB consumer and
sending messages with a short TTL.  The expiration logic when
receiveing an expired Message Ack will now only expire messages
in dispatch relating to the received ack, not all expired messages
in the dispatch list.
"
AMQ-5859 JmsConnector Reconnection logic seems wrong,"https://issues.apache.org/jira/browse/AMQ-5859
",122,"https://issues.apache.org/jira/browse/AMQ-5859
"
AMQ-5922: Update Import-Package to include Spring 4,"Update OSGi metadata to include Spring 4.X in the version range. OSGi bundles for Spring 4.X are provided by the Apache ServiceMix project. Removed duplicate org.springframework.osgi\* package reference.

This version range matches the range used in the activemq-camel module.
",121,"Update OSGi metadata to include Spring 4.X in the version range. OSGi bundles for Spring 4.X are provided by the Apache ServiceMix project. Removed duplicate org.springframework.osgi\* package reference.

This version range matches the range used in the activemq-camel module.
"
[AMQ-5858] add import package,,120,
AMQ-5821,"Improved fix based on current master
",119,"Improved fix based on current master
"
https://issues.apache.org/jira/browse/AMQ-5745,"This commit is based off a patch submitted by admin@int3solutions.com.
It fixes several locations in the code where there are potential resource leaks.
",118,"This commit is based off a patch submitted by admin@int3solutions.com.
It fixes several locations in the code where there are potential resource leaks.
"
https://issues.apache.org/jira/browse/AMQ-5705,"Modifing the AdivsoryBroker to set the originBrokerURL to the transport connector's
URL if it has been set versus using a default URL.
",117,"Modifing the AdivsoryBroker to set the originBrokerURL to the transport connector's
URL if it has been set versus using a default URL.
"
https://issues.apache.org/jira/browse/AMQ-5668,"This commit fixes a race condition in AbstractStoreCursor setLastCacheId that could
cause a null pointer exception in certain cases.
",116,"This commit fixes a race condition in AbstractStoreCursor setLastCacheId that could
cause a null pointer exception in certain cases.
"
https://issues.apache.org/jira/browse/AMQ-5843,"Adding a new property on PolicyEntry called includeBodyForAdvisory which will
include the original message body when sending advisory messages that include
the original message, instead of clearing it out.  This is turned off by default.
",115,"Adding a new property on PolicyEntry called includeBodyForAdvisory which will
include the original message body when sending advisory messages that include
the original message, instead of clearing it out.  This is turned off by default.
"
https://issues.apache.org/jira/browse/AMQ-5265,"This is a revision of AMQ-5265 -- the original fix didn't quite clean up all of the mbeans that MBeanBridgeDestination created, as [noted in the original issue by Tarek Hammoud](https://issues.apache.org/jira/browse/AMQ-5265?focusedCommentId=14527137&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14527137).  The key for the map used to track the ObjectNames was an ActiveMQDestination (which uses the destination's physical name for its equals() implementation) caused the inbound and outbound entries in the map to randomly replace each other.

Like Tarek, I could reproduce this issue using 5.11.1 with two networked brokers (full duplex) with a client publishing to a topic.  After I restart a broker, the logs on the non-restarted broker show the MBeanBridgeDestination reporting many InstanceAlreadyExistsExceptions when trying to register the unintentionally-duplicated mbeans.

Please let me know if this makes sense or if there are any changes you would suggest (ex: is there a reasonable way or an example I could follow to add a unit test for something like this?).  Thanks!
",114,"This is a revision of AMQ-5265 -- the original fix didn't quite clean up all of the mbeans that MBeanBridgeDestination created, as [noted in the original issue by Tarek Hammoud](https://issues.apache.org/jira/browse/AMQ-5265?focusedCommentId=14527137&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14527137).  The key for the map used to track the ObjectNames was an ActiveMQDestination (which uses the destination's physical name for its equals() implementation) caused the inbound and outbound entries in the map to randomly replace each other.

Like Tarek, I could reproduce this issue using 5.11.1 with two networked brokers (full duplex) with a client publishing to a topic.  After I restart a broker, the logs on the non-restarted broker show the MBeanBridgeDestination reporting many InstanceAlreadyExistsExceptions when trying to register the unintentionally-duplicated mbeans.

Please let me know if this makes sense or if there are any changes you would suggest (ex: is there a reasonable way or an example I could follow to add a unit test for something like this?).  Thanks!
"
https://issues.apache.org/jira/browse/AMQ-5837,"This commit adds an Inflight message size statistic to SubscriptionStatistics so we can know the size of all the messages that are inflight, besides just the count.
",113,"This commit adds an Inflight message size statistic to SubscriptionStatistics so we can know the size of all the messages that are inflight, besides just the count.
"
https://issues.apache.org/jira/browse/AMQ-5811,"Added synchronization blocks around sentitive code to
prevent concurrent modification of the HashMap.
",112,"Added synchronization blocks around sentitive code to
prevent concurrent modification of the HashMap.
"
https://issues.apache.org/jira/browse/AMQ-5836,"Modifying start up scripts to consistently use the same property names
",111,"Modifying start up scripts to consistently use the same property names
"
https://issues.apache.org/jira/browse/AMQ-5393,"Adding a property called schedulePeriodForDiskUsageCheck which can be set
to a time period to periodically check disk usage limits and adjust if the amount of 
disk space has been reduced.
",110,"Adding a property called schedulePeriodForDiskUsageCheck which can be set
to a time period to periodically check disk usage limits and adjust if the amount of 
disk space has been reduced.
"
Renames env script to avoid possible POSIX env shadowing,"Got an issue with other shell scripts, turns out that when one prepends `$PATH` by `activemq/bin`, `env` is shadowed by ActiveMQ's `env`.

That means that script that want to run commands in customized environment will simple don't be executed like : 

``` sh
env A=aaa B=bbb mv ...
```

Worse such lines won't fail, because this will return the `0` exit status. The workaround is simple, i.e. append in `%PATH` instead of prepend. But a proper fix is needed. This PR proposes to rename the shell script from `env` to `activemq-env`.
",109,"Got an issue with other shell scripts, turns out that when one prepends `$PATH` by `activemq/bin`, `env` is shadowed by ActiveMQ's `env`.

That means that script that want to run commands in customized environment will simple don't be executed like : 

``` sh
env A=aaa B=bbb mv ...
```

Worse such lines won't fail, because this will return the `0` exit status. The workaround is simple, i.e. append in `%PATH` instead of prepend. But a proper fix is needed. This PR proposes to rename the shell script from `env` to `activemq-env`.
"
"fix for: ""--msgsel"" for the purge command not working as described","The help of ""activemq purge"" states

```
Main purge --msgsel \""JMSMessageID='*:10',JMSPriority>5\"" FOO.*
    - Delete all the messages in the destinations that matches FOO.* and has a JMSMessageID in
      the header field that matches the wildcard *:10, and has a JMSPriority field > 5 in the
      queue FOO.BAR.
      SLQ92 syntax is also supported.
```

But passing `JMSMessageID='*:10'` as selector for the purge command doesn't purge a message  even the message exsist. The pull request provide a code fix and a related unit test.

The message selector in the browse command works as described.

```
activemq browse --amqurl tcp://localhost:61616 --msgsel ""JMSMessageID='*:10'"" TEST

JMS_BODY_FIELD:JMSText = test message: 9
JMS_HEADER_FIELD:JMSExpiration = 0
JMS_HEADER_FIELD:JMSMessageID = ID:HIDDEN-63485-1433505789304-1:1:1:1:10
JMS_HEADER_FIELD:JMSPriority = 4
JMS_HEADER_FIELD:JMSDestination = TEST
JMS_HEADER_FIELD:JMSTimestamp = 1433505789534
JMS_HEADER_FIELD:JMSRedelivered = false
JMS_HEADER_FIELD:JMSDeliveryMode = persistent
```

Using the same selector for the purge command does not work.

```
activemq purge --msgsel ""JMSMessageID='*:10'"" TEST
INFO: Removed: 0 messages for message selector JMSMessageID='*:10'

activemq purge --msgsel ""JMSMessageID='*:10',JMSPriority=4"" TEST
INFO: Removed: 0 messages for message selector (JMSMessageID='%:10') AND (JMSPriority=4)
```

Passing the whole message ID purge the selected message.

```
activemq purge --msgsel ""JMSMessageID='ID:HIDDEN-63485-1433505789304-1:1:1:1:10'"" TEST

INFO: Removed: 1 messages for message selector JMSMessageID='ID:HIDDEN-63485-1433505789304-1:1:1:1:10'
```
",108,"The help of ""activemq purge"" states

```
Main purge --msgsel \""JMSMessageID='*:10',JMSPriority>5\"" FOO.*
    - Delete all the messages in the destinations that matches FOO.* and has a JMSMessageID in
      the header field that matches the wildcard *:10, and has a JMSPriority field > 5 in the
      queue FOO.BAR.
      SLQ92 syntax is also supported.
```

But passing `JMSMessageID='*:10'` as selector for the purge command doesn't purge a message  even the message exsist. The pull request provide a code fix and a related unit test.

The message selector in the browse command works as described.

```
activemq browse --amqurl tcp://localhost:61616 --msgsel ""JMSMessageID='*:10'"" TEST

JMS_BODY_FIELD:JMSText = test message: 9
JMS_HEADER_FIELD:JMSExpiration = 0
JMS_HEADER_FIELD:JMSMessageID = ID:HIDDEN-63485-1433505789304-1:1:1:1:10
JMS_HEADER_FIELD:JMSPriority = 4
JMS_HEADER_FIELD:JMSDestination = TEST
JMS_HEADER_FIELD:JMSTimestamp = 1433505789534
JMS_HEADER_FIELD:JMSRedelivered = false
JMS_HEADER_FIELD:JMSDeliveryMode = persistent
```

Using the same selector for the purge command does not work.

```
activemq purge --msgsel ""JMSMessageID='*:10'"" TEST
INFO: Removed: 0 messages for message selector JMSMessageID='*:10'

activemq purge --msgsel ""JMSMessageID='*:10',JMSPriority=4"" TEST
INFO: Removed: 0 messages for message selector (JMSMessageID='%:10') AND (JMSPriority=4)
```

Passing the whole message ID purge the selected message.

```
activemq purge --msgsel ""JMSMessageID='ID:HIDDEN-63485-1433505789304-1:1:1:1:10'"" TEST

INFO: Removed: 1 messages for message selector JMSMessageID='ID:HIDDEN-63485-1433505789304-1:1:1:1:10'
```
"
[AMQ-5821] Avoid probing of classes in Activator,,107,
AMQ-5713 - making accessors public to remove startup error.,"Includes unit test DestinationBridgeAccessorsTest which replicated the problem and now passes.
",106,"Includes unit test DestinationBridgeAccessorsTest which replicated the problem and now passes.
"
https://issues.apache.org/jira/browse/AMQ-5813,"Fixing countBeforeFull for TopicSubscriptions to report a positive value
",105,"Fixing countBeforeFull for TopicSubscriptions to report a positive value
"
[AMQ-5796] Incorrect Task Usage mentioned for amq browse command for …,"…the msgsel option
",104,"…the msgsel option
"
https://issues.apache.org/jira/browse/AMQ-5771,"Including remote ip address when logging authentication failures
",103,"Including remote ip address when logging authentication failures
"
https://issues.apache.org/jira/browse/AMQ-5792 - Adding SubscriptionStatistics,"Adding SubscriptionStatistics to group together all metrics in a bean
for a subscription.
",102,"Adding SubscriptionStatistics to group together all metrics in a bean
for a subscription.
"
Fixing missing volatile on references in VMTransport,"Fixing missing volatile on references in VMTransport to prevent a synchronization bug.

This resolves https://issues.apache.org/jira/browse/AMQ-5787
",101,"Fixing missing volatile on references in VMTransport to prevent a synchronization bug.

This resolves https://issues.apache.org/jira/browse/AMQ-5787
"
AMQ-5782 Added support to the Resource Adapter for SSL,,100,
Adding maxFrameSize to the Stomp Protocol,"Adding maxFrameSize to the Stomp Protocol so that a maximum frame size can be validated to be consistent with OpenWire.

This applies to https://issues.apache.org/jira/browse/AMQ-5776
",99,"Adding maxFrameSize to the Stomp Protocol so that a maximum frame size can be validated to be consistent with OpenWire.

This applies to https://issues.apache.org/jira/browse/AMQ-5776
"
Adding the ability to limit the maximum size of a message,"Adding the ability to limit the maximum size of a message sent by a client per transport.

This can be configured in on the transport connector in xml.  For example:

``` xml
<broker>
  ...
  <transportConnectors>
    <transportConnector name=""nio"" uri=""nio://0.0.0.0:61616"" maximumMessageSize=""1 mb""/>  
  </<transportConnectors>
  ...
</broker>
```

This resolves https://issues.apache.org/jira/browse/AMQ-5774
",98,"Adding the ability to limit the maximum size of a message sent by a client per transport.

This can be configured in on the transport connector in xml.  For example:

``` xml
<broker>
  ...
  <transportConnectors>
    <transportConnector name=""nio"" uri=""nio://0.0.0.0:61616"" maximumMessageSize=""1 mb""/>  
  </<transportConnectors>
  ...
</broker>
```

This resolves https://issues.apache.org/jira/browse/AMQ-5774
"
Adding a configuration option set max destinations on the broker,"Adding a configuration option to PolicyEntry to enable setting the maximum number of created destinations by policy on the broker.

This resolves https://issues.apache.org/jira/browse/AMQ-5751
",97,"Adding a configuration option to PolicyEntry to enable setting the maximum number of created destinations by policy on the broker.

This resolves https://issues.apache.org/jira/browse/AMQ-5751
"
Add use case using 2 consumers where one is Low and the other High. Exte...,"- Add use case init test using 2 consumers where one is a Low and the other a High Priority user. 
- Extend the use case using prefetchSize to verify that the High priority consumer gets just 5 messages while the second gets 15 messages. That validates the hypothesis described within the doc - last sentence here - http://activemq.apache.org/consumer-priority.html
",96,"- Add use case init test using 2 consumers where one is a Low and the other a High Priority user. 
- Extend the use case using prefetchSize to verify that the High priority consumer gets just 5 messages while the second gets 15 messages. That validates the hypothesis described within the doc - last sentence here - http://activemq.apache.org/consumer-priority.html
"
Add use case with 2 consumers where one is exclusive,"Example where we start 2 consumers where one is exclusive and not the second and we control/check that all the messages are consumed by the exclusive
",95,"Example where we start 2 consumers where one is exclusive and not the second and we control/check that all the messages are consumed by the exclusive
"
Add example using retroactive customer with a fixedsubscriptionrecoveryp...,"Add example using retroactive customer with a fixedsubscriptionrecoverypolicy for JMS Topic and broker restarted

Remark : The example works not matter if we use the property ""consumer.retroactive=true/false"". Is there a mistake within the code of the example ?
",94,"Add example using retroactive customer with a fixedsubscriptionrecoverypolicy for JMS Topic and broker restarted

Remark : The example works not matter if we use the property ""consumer.retroactive=true/false"". Is there a mistake within the code of the example ?
"
Added an uncaught exception handler to ThreadPoolExecutor," Added an uncaught exception handler to ThreadPoolExecutor getExecutor() method to log errors in threads.

This resolves https://issues.apache.org/jira/browse/AMQ-5750
",93," Added an uncaught exception handler to ThreadPoolExecutor getExecutor() method to log errors in threads.

This resolves https://issues.apache.org/jira/browse/AMQ-5750
"
Added a getMessageSize method to MessageStore,"Added a getMessageSize method to MessageStore to support retrieving the total message size of all stored messages for a destination.  This is useful for metrics.

This resolves https://issues.apache.org/jira/browse/AMQ-5748
",92,"Added a getMessageSize method to MessageStore to support retrieving the total message size of all stored messages for a destination.  This is useful for metrics.

This resolves https://issues.apache.org/jira/browse/AMQ-5748
"
AMQ-4693 Adds Kerberos 5 authentication and connection encryption over TLS,"Basing on RFC2712
",91,"Basing on RFC2712
"
AMQ-5713 - adding getDoHandlReplyTo to satisfy spring config load errors,"For:

https://issues.apache.org/jira/browse/AMQ-5713
",90,"For:

https://issues.apache.org/jira/browse/AMQ-5713
"
Set eclipse plugin version in leveldb-store pom,,89,
Do not log passwords on MBean method calls.,"Previous to this patch the AnnotatedMBean class would simply dump
any arguments passed in via JMX call to the log (when audit is enabled).
Method parameters can sometimes contain sensitive information such as
the password field on QueueView.sendTextMessage.

This patch adds a @Sensitive annotation to the JMX module allowing
implementations of MBean interfaces to mark method parameters as sensitive
preventing values from being logged.
",88,"Previous to this patch the AnnotatedMBean class would simply dump
any arguments passed in via JMX call to the log (when audit is enabled).
Method parameters can sometimes contain sensitive information such as
the password field on QueueView.sendTextMessage.

This patch adds a @Sensitive annotation to the JMX module allowing
implementations of MBean interfaces to mark method parameters as sensitive
preventing values from being logged.
"
AMQ-5721 - Update ActiveMQ to use commons-pool2 instead of commons-pool....,"...AMQ-5636 will need it. The JMS pool and other components should use it as well.
",87,"...AMQ-5636 will need it. The JMS pool and other components should use it as well.
"
Updated durable related error messages in TopicRegion,"Updated durable related error messages in TopicRegion to include both subscriptionName and clientId.

```
This resolves https://issues.apache.org/jira/browse/AMQ-5719
```
",86,"Updated durable related error messages in TopicRegion to include both subscriptionName and clientId.

```
This resolves https://issues.apache.org/jira/browse/AMQ-5719
```
"
Add support for suffix destination filtering.,,85,
Modified StoreQueueCursor to prevent a broker deadlock,"Modified StoreQueueCursor to properly implement tryAddMessageLast so that the message lock can be released during a timeout when the temporary store is full.  Updated Queue to call tryAddMessageLast instead of addMessageLast in the cursorAdd method.

```
This resolves https://issues.apache.org/jira/browse/AMQ-5712
```
",84,"Modified StoreQueueCursor to properly implement tryAddMessageLast so that the message lock can be released during a timeout when the temporary store is full.  Updated Queue to call tryAddMessageLast instead of addMessageLast in the cursorAdd method.

```
This resolves https://issues.apache.org/jira/browse/AMQ-5712
```
"
https://issues.apache.org/jira/browse/AMQ-5714,,83,
AMQ-5709 Reworking Logging on Locker,"https://issues.apache.org/jira/browse/AMQ-5709

This is about changing how the Log is done in case of not being able to lock (log only once)
",82,"https://issues.apache.org/jira/browse/AMQ-5709

This is about changing how the Log is done in case of not being able to lock (log only once)
"
Trunk kerberos,"AMQ-4693
",81,"AMQ-4693
"
Ensure JMX is started on XBeanBrokerService,"Using the XBeanBrokerService with JMX and Scheduler Support enabled.
The ManagementContext is never started when in slave mode, since
afterPropertiesSet() blocks trying to get the scheduler shared file
lock.  This patch updates the XBeanBrokerService to start the
BrokerService ManagementContext (when isJMX==true) before trying
to get the job scheduler shared file lock..
",80,"Using the XBeanBrokerService with JMX and Scheduler Support enabled.
The ManagementContext is never started when in slave mode, since
afterPropertiesSet() blocks trying to get the scheduler shared file
lock.  This patch updates the XBeanBrokerService to start the
BrokerService ManagementContext (when isJMX==true) before trying
to get the job scheduler shared file lock..
"
Improved filename sanitization,,79,
Improved filename sanitization,,78,
Improved filename sanitization,,77,
fix the inconsistency with ElectingLevelDBStore.isMaster() under AMQ-5082,"I've run through 100 iterations of the ElectingLevelDBStoreTest, I believe this fixes the intermittent issue with the ElectingLevelDBStore failing its isMaster() check.
",76,"I've run through 100 iterations of the ElectingLevelDBStoreTest, I believe this fixes the intermittent issue with the ElectingLevelDBStore failing its isMaster() check.
"
Lichtin patch 1,"AMQ-5669: Update Karaf feature files to add required namespace
",75,"AMQ-5669: Update Karaf feature files to add required namespace
"
AMQ-5082 unit test and patch,"A proposed unit test and patch to address the issues raised in AMQ-5082 (the quorum never recovered after a broker's zookeeper session expires)
",74,"A proposed unit test and patch to address the issues raised in AMQ-5082 (the quorum never recovered after a broker's zookeeper session expires)
"
AMQ-5662 Improve web console retry to support all DLQ names,"https://issues.apache.org/jira/browse/AMQ-5662

Retry link in webconsole is changed from using move and pattern based DLQ identification to use AMQ built in DLQ query and retry mechanism.
",73,"https://issues.apache.org/jira/browse/AMQ-5662

Retry link in webconsole is changed from using move and pattern based DLQ identification to use AMQ built in DLQ query and retry mechanism.
"
"AMQ-5659 Safety measure against infinite loop in ""purge"" (V2)",,72,
"AMQ-5659 Safety measure against infinite loop in ""purge""",,71,
AMQ-5654 Allow ActiveMQ authentication on server side for REST/Ajax clients.,"Allow credentials from servlet context, allow to override with system properties via placeholders.
",70,"Allow credentials from servlet context, allow to override with system properties via placeholders.
"
AMQ-5645 - Updated DayOfMonth cron to roll to next month properly.,"For the Minutes and Hours tokens in CronParser.buildCronEntries() the CronEntry.end value was correctly +1 of actually allowed end values (ex. a time of 10:60 is not possible).  Updated DayOfMonth to also be +1 (32 instead of 31).  Expanded unit tests included.
",69,"For the Minutes and Hours tokens in CronParser.buildCronEntries() the CronEntry.end value was correctly +1 of actually allowed end values (ex. a time of 10:60 is not possible).  Updated DayOfMonth to also be +1 (32 instead of 31).  Expanded unit tests included.
"
AMQ-5649: Fixed max producers per connection for anonymous producers,"Modified TransportConnection so that maximumProducersAllowedPerConnection will be enforced even for anonymous producers.

This resolves https://issues.apache.org/jira/browse/AMQ-5649

Two unit tests have been added for this ticket.
",68,"Modified TransportConnection so that maximumProducersAllowedPerConnection will be enforced even for anonymous producers.

This resolves https://issues.apache.org/jira/browse/AMQ-5649

Two unit tests have been added for this ticket.
"
Changes for https://issues.apache.org/jira/browse/AMQ-5642.,"This would allow for configuration in the resource-adapter like this:

``` xml
<admin-object class-name=""org.apache.activemq.ActiveMQXAConnectionFactory"" jndi-name=""java:/AMQXAConnectionFactory"" enabled=""true"" use-java-context=""true"" pool-name=""AMQXAConnectionFactory"">
    <config-property name=""brokerURL"">
          failover:(tcp://localhost:61616)?jms.rmIdFromConnectionId=true&amp;maxReconnectAttempts=0&amp;jms.xaAckMode=2&amp;jms.userName=admin&amp;jms.password=admin
     </config-property>
</admin-object>
```
",67,"This would allow for configuration in the resource-adapter like this:

``` xml
<admin-object class-name=""org.apache.activemq.ActiveMQXAConnectionFactory"" jndi-name=""java:/AMQXAConnectionFactory"" enabled=""true"" use-java-context=""true"" pool-name=""AMQXAConnectionFactory"">
    <config-property name=""brokerURL"">
          failover:(tcp://localhost:61616)?jms.rmIdFromConnectionId=true&amp;maxReconnectAttempts=0&amp;jms.xaAckMode=2&amp;jms.userName=admin&amp;jms.password=admin
     </config-property>
</admin-object>
```
"
AMQ-5636 - Update DBCP to a much more recent version,"AMQ-5636 - Update DBCP to a much more recent version
",66,"AMQ-5636 - Update DBCP to a much more recent version
"
Burton concurrent destination gc,"Improves performance of concurrent destination GC dramatically. 
",65,"Improves performance of concurrent destination GC dramatically. 
"
Fix to only include the activemq opts for memory when start is called.  ...,"...If we don't do this we end up potentially allocating too much memory if -Xms is a high value.
",64,"...If we don't do this we end up potentially allocating too much memory if -Xms is a high value.
"
"revise set and get methods name of Activation Spec properties ""Redeliver...","...yBackOffMultiplier"" and ""RedeliveryUseExponentialBackOff"" to allow configuration through @ActivationConfigProperty.

https://issues.apache.org/jira/browse/AMQ-5613

Activation Spec properties[1] ""RedeliveryBackOffMultiplier"" and ""RedeliveryUseExponentialBackOff"" can not be used within @ActivationConfigProperty, in contrast, it accepts ""backOffMultiplier"" and ""useExponentialBackOff"".

[1] http://activemq.apache.org/resource-adapter-properties.html
",63,"...yBackOffMultiplier"" and ""RedeliveryUseExponentialBackOff"" to allow configuration through @ActivationConfigProperty.

https://issues.apache.org/jira/browse/AMQ-5613

Activation Spec properties[1] ""RedeliveryBackOffMultiplier"" and ""RedeliveryUseExponentialBackOff"" can not be used within @ActivationConfigProperty, in contrast, it accepts ""backOffMultiplier"" and ""useExponentialBackOff"".

[1] http://activemq.apache.org/resource-adapter-properties.html
"
AMQ-4598 purge enhancement,"Reset queue counter during ""purge"" to the number of inflight messages, so that they are not ""hidden"" while still being processed.
",62,"Reset queue counter during ""purge"" to the number of inflight messages, so that they are not ""hidden"" while still being processed.
"
AMQ-5503 - Make init script more reliable,"See https://issues.apache.org/jira/browse/AMQ-5503
Unfortunately the merge of this fix was delayed without any communicated reason.
Therefore i recreated the pull request.
",61,"See https://issues.apache.org/jira/browse/AMQ-5503
Unfortunately the merge of this fix was delayed without any communicated reason.
Therefore i recreated the pull request.
"
https://issues.apache.org/jira/browse/AMQ-4929 - remove old and unused org.apache.activemq.broker.BrokerService#setSupportFailOver,"I've removed the unused method `org.apache.activemq.broker.BrokerService#setSupportFailOver`. Thank you for taking the time to review this patch and merging to master.
",60,"I've removed the unused method `org.apache.activemq.broker.BrokerService#setSupportFailOver`. Thank you for taking the time to review this patch and merging to master.
"
https://issues.apache.org/jira/browse/AMQ-4848 - Karaf update added Transport Connectors...,"This was a fix that I sent pull request #28 which was from Jun 17, 2014. I fixed activemq:list command and it now displays the transport connectors available for the broker on karaf. Can anyone review this patch. If the fix is good then can this be merged? 

![screen shot 2015-02-11 at 4 14 05 pm 2](https://cloud.githubusercontent.com/assets/1269759/6156952/a8b3eae2-b20b-11e4-8cd1-7ae9bca809d0.png)

Also I've updated the pax exam unit test so the integration test does not fail.

![screen shot 2015-02-11 at 4 26 39 pm 2](https://cloud.githubusercontent.com/assets/1269759/6156968/cfaef740-b20b-11e4-9dd7-1fe04a2e84b9.png)
",59,"This was a fix that I sent pull request #28 which was from Jun 17, 2014. I fixed activemq:list command and it now displays the transport connectors available for the broker on karaf. Can anyone review this patch. If the fix is good then can this be merged? 

![screen shot 2015-02-11 at 4 14 05 pm 2](https://cloud.githubusercontent.com/assets/1269759/6156952/a8b3eae2-b20b-11e4-8cd1-7ae9bca809d0.png)

Also I've updated the pax exam unit test so the integration test does not fail.

![screen shot 2015-02-11 at 4 26 39 pm 2](https://cloud.githubusercontent.com/assets/1269759/6156968/cfaef740-b20b-11e4-9dd7-1fe04a2e84b9.png)
"
Fixed bug for cron test.,"The test method(org.apache.activemq.broker.scheduler.CronParserTest.testgetNextTimeMinutes) is failure on my machine,because the result of calender.setTimeInMillis(0) is 1970-01-01 08:30:00 not 1970-01-01 08:00:00.
The result of expresssion(next - current) should be 60_40_1000 not 60_10_1000. 
",58,"The test method(org.apache.activemq.broker.scheduler.CronParserTest.testgetNextTimeMinutes) is failure on my machine,because the result of calender.setTimeInMillis(0) is 1970-01-01 08:30:00 not 1970-01-01 08:00:00.
The result of expresssion(next - current) should be 60_40_1000 not 60_10_1000. 
"
StoreDurableSubscriberCursor don't set its inner cursors' maxProducersToAudit correctly,"StoreDurableSubscriberCursor don't set its inner cursors' maxProducersToAudit correctly
",57,"StoreDurableSubscriberCursor don't set its inner cursors' maxProducersToAudit correctly
"
Add getUptimeMillis() to the BrokerView MBean,"I need to be able to get the up-time of the broker in milliseconds, rather than as a formatted string.
",56,"I need to be able to get the up-time of the broker in milliseconds, rather than as a formatted string.
"
AMQ-5503 - Make init script more reliable,"see https://issues.apache.org/jira/browse/AMQ-5503
",55,"see https://issues.apache.org/jira/browse/AMQ-5503
"
Remaining changes create in context of AMQ-5378,"This pullrequest assembles various changes which stabilize and improve the activemq unix init script.
",54,"This pullrequest assembles various changes which stabilize and improve the activemq unix init script.
"
Fix for https://issues.apache.org/jira/browse/AMQ-5174 ,"- Cannot use the `JDBCIOExceptionHandler` when `KahaDB` is configured to use a `lease-database-locker`.
",53,"- Cannot use the `JDBCIOExceptionHandler` when `KahaDB` is configured to use a `lease-database-locker`.
"
Next step of refactoring,"All changes were successfully tested on Ubuntu and MacOSX with the new test suite.
(assembly/src/test/sh/init-script-testsuite)
",52,"All changes were successfully tested on Ubuntu and MacOSX with the new test suite.
(assembly/src/test/sh/init-script-testsuite)
"
"Heavy refactoring, enhancements and testsuite for the initscript","I removed the ""env"" file and its logic because this file increases the complexity.
(Especially on cygwin)
",51,"I removed the ""env"" file and its logic because this file increases the complexity.
(Especially on cygwin)
"
Fixed AMQ-5438. Added code to create KahaDB journal archive location relative to the data directory by default,"Fixed. Added unit test for the issue. Added accessors and listener to allow latching on journal activity for testing.
",50,"Fixed. Added unit test for the issue. Added accessors and listener to allow latching on journal activity for testing.
"
Fixed AMQ-5436. Added logic for temporary destinations in producer and consumer.,"The test tool now supports the use of the temp-queue: and temp-topic: prefixes in addition to queue: and topic:.

Functionality is as follows:
activemq-perf:consumer -Dconsumer.destName=temp-queue://foo 
Code ignores ""foo"", and creates a temporary queue with an ActiveMQ client-generated name.
activemq-perf:producer -Dconsumer.destName=temp-queue://foo 
Code sends messages to a queue called ""temp-queue://foo"".

Unit tests included. Verified as working correctly against a 5.10 broker.
",49,"The test tool now supports the use of the temp-queue: and temp-topic: prefixes in addition to queue: and topic:.

Functionality is as follows:
activemq-perf:consumer -Dconsumer.destName=temp-queue://foo 
Code ignores ""foo"", and creates a temporary queue with an ActiveMQ client-generated name.
activemq-perf:producer -Dconsumer.destName=temp-queue://foo 
Code sends messages to a queue called ""temp-queue://foo"".

Unit tests included. Verified as working correctly against a 5.10 broker.
"
refactoring of the initscript,"- The current version of the script seems to be a bit
  broken, because the ""setup"" option creates a strange looking config.
- The invocation task like ""bstat"" is not executed anymore if the broker
  is not running.
- Fixed a classloader problem.
- Improved default configuration and help output.
",48,"- The current version of the script seems to be a bit
  broken, because the ""setup"" option creates a strange looking config.
- The invocation task like ""bstat"" is not executed anymore if the broker
  is not running.
- Fixed a classloader problem.
- Improved default configuration and help output.
"
https://issues.apache.org/jira/browse/AMQ-5381,"Modified ActiveMQBytesMessage so that the 'compressed' flag is only set when the 'content' is stored, instead of whenever writing is initialized.  This resolves https://issues.apache.org/jira/browse/AMQ-5381

Added unit test to test for AMQ-5381 condition.
",47,"Modified ActiveMQBytesMessage so that the 'compressed' flag is only set when the 'content' is stored, instead of whenever writing is initialized.  This resolves https://issues.apache.org/jira/browse/AMQ-5381

Added unit test to test for AMQ-5381 condition.
"
First step of some refactoring,"This is the first step of my refactoring of the init script. 
",46,"This is the first step of my refactoring of the init script. 
"
[Fixed] https://issues.apache.org/jira/browse/AMQ-5344,"added connector feature from karaf to avoid several transaction managers to get active.  
",45,"added connector feature from karaf to avoid several transaction managers to get active.  
"
AMQ-5281: Incorrect handling of unknown values in selectors,"See https://issues.apache.org/jira/browse/AMQ-5281 for details.
",44,"See https://issues.apache.org/jira/browse/AMQ-5281 for details.
"
"AMQ-5318: JDBC store; commit called on connection that uses autocommit during ""deleteAllMessages""","issue reported at AMQ-5318
",43,"issue reported at AMQ-5318
"
https://issues.apache.org/jira/browse/AMQ-5295 HTTPS Network Connector doesn't work with Mutual,"authentication- HTTPSClientTransport uses wrong SSLSocketFactory
",42,"authentication- HTTPSClientTransport uses wrong SSLSocketFactory
"
https://issues.apache.org/jira/browse/AMQ-5220 Empty body for Statistics,"Advisory Messages when using STOMP protocol
",41,"Advisory Messages when using STOMP protocol
"
https://issues.apache.org/jira/browse/AMQ-5295,"HTTPS Network Connector doesn't work with Mutual authentication- HTTPSClientTransport uses wrong SSLSocketFactory
",40,"HTTPS Network Connector doesn't work with Mutual authentication- HTTPSClientTransport uses wrong SSLSocketFactory
"
Fix for AMQ-5306,"Cleaned up logic around the use of comma separated destinations, sysTest.totalDests and producer.destComposite. The logic is as follows:

Given -Dproducer.destName=foo:
default (-DsysTest.totalDests=1)
- publishes to 1 destination - foo

-DsysTest.totalDests=2
- publishes to 2 destinations - foo.0, foo.1

Given -Dproducer.destName=foo,cheese:
default (-Dproducer.destComposite=false -DsysTest.totalDests=1)
- publishes to 2 destinations - foo and cheese

(-Dproducer.destComposite=false) -DsysTest.totalDests=2
- publishes to 4 destinations - foo.0, foo.1 and cheese.0, cheese.1

-Dproducer.destComposite=true (-DsysTest.totalDests=1)
- publishes to 1 composite destination - ""foo,cheese""

-Dproducer.destComposite=true -DsysTest.totalDests=2
- publishes to 1 composite destination - ""foo.0,foo.1,cheese.0,cheese.1""
",39,"Cleaned up logic around the use of comma separated destinations, sysTest.totalDests and producer.destComposite. The logic is as follows:

Given -Dproducer.destName=foo:
default (-DsysTest.totalDests=1)
- publishes to 1 destination - foo

-DsysTest.totalDests=2
- publishes to 2 destinations - foo.0, foo.1

Given -Dproducer.destName=foo,cheese:
default (-Dproducer.destComposite=false -DsysTest.totalDests=1)
- publishes to 2 destinations - foo and cheese

(-Dproducer.destComposite=false) -DsysTest.totalDests=2
- publishes to 4 destinations - foo.0, foo.1 and cheese.0, cheese.1

-Dproducer.destComposite=true (-DsysTest.totalDests=1)
- publishes to 1 composite destination - ""foo,cheese""

-Dproducer.destComposite=true -DsysTest.totalDests=2
- publishes to 1 composite destination - ""foo.0,foo.1,cheese.0,cheese.1""
"
Fix for AMQ-5301,"Modified the destination construction logic so that numerical prefixes are appended only if sysTest.totalDests is greater than 1.
",38,"Modified the destination construction logic so that numerical prefixes are appended only if sysTest.totalDests is greater than 1.
"
Web-console does not initialize under Spring-4.x because dispatcher-serv...,"...let.xml has very old bean definition.
",37,"...let.xml has very old bean definition.
"
Fix for AMQ-5249,"Approach to the change is described in http://issues.apache.org/jira/browse/AMQ-5294?focusedCommentId=14077910&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14077910

For some reason there is also a commit in this pull request that was already merged (Added close destroy-method...), apologies something messed up in the workflow.
",36,"Approach to the change is described in http://issues.apache.org/jira/browse/AMQ-5294?focusedCommentId=14077910&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14077910

For some reason there is also a commit in this pull request that was already merged (Added close destroy-method...), apologies something messed up in the workflow.
"
Fix typo,,35,
Cleanup in ConnectTest,"Cleanup in ConnectTest to do two things:
1) connect/disconnect 500 (which still seems high) times instead of as many as possible in 25seconds.  On fast machines, this is MUCH faster.
2) Actually call Thead.start(), not Thread.run() in cases where it should be on a background thread.
",34,"Cleanup in ConnectTest to do two things:
1) connect/disconnect 500 (which still seems high) times instead of as many as possible in 25seconds.  On fast machines, this is MUCH faster.
2) Actually call Thead.start(), not Thread.run() in cases where it should be on a background thread.
"
[AMQ-5269] Update NIO based transports to use a Select mechanism,"Update NIO based transports to use a Select mechanism for the accepts instead of the blocking select.

Cuts about 10 minutes off the activemq-stomp tests, drops the NIO test execution time down to equal to the non-NIO based tests.
",33,"Update NIO based transports to use a Select mechanism for the accepts instead of the blocking select.

Cuts about 10 minutes off the activemq-stomp tests, drops the NIO test execution time down to equal to the non-NIO based tests.
"
"Load into M2E, update to Java 7","The changes fall into a few categories:
1) top level pom has a few updates to update the source/target to 1.7 to make the rest of this actually work
2) Update the lifecycle-mapping stuff to actually run some of the plugins so that code is properly generated
3) Change from the jaxb-maven-plugin to CXF's xjc-plugin (which works with java8 without the system property hack).  CXF's xjc-plugin has the lifecycle stuff built in.
4) Add build-helper plugin to make sure the generated dirs are added all the time so that m2e picks them up.

With the changes, you can git clone a clean activemq and pull it directly into eclipse (providing you have all the scala stuff installed), do a quick Maven -> Refresh Projects (not sure why that is needed), and it all builds without any errors.
",32,"The changes fall into a few categories:
1) top level pom has a few updates to update the source/target to 1.7 to make the rest of this actually work
2) Update the lifecycle-mapping stuff to actually run some of the plugins so that code is properly generated
3) Change from the jaxb-maven-plugin to CXF's xjc-plugin (which works with java8 without the system property hack).  CXF's xjc-plugin has the lifecycle stuff built in.
4) Add build-helper plugin to make sure the generated dirs are added all the time so that m2e picks them up.

With the changes, you can git clone a clean activemq and pull it directly into eclipse (providing you have all the scala stuff installed), do a quick Maven -> Refresh Projects (not sure why that is needed), and it all builds without any errors.
"
AMQ-5265 - fix race condition for task,"AMQ-5265 - fix race condition for task in MBeanBridgeDestination for running the purgeInactiveDestinationViewTask and the execution of onOutboundMessage and onInboundMessage
",31,"AMQ-5265 - fix race condition for task in MBeanBridgeDestination for running the purgeInactiveDestinationViewTask and the execution of onOutboundMessage and onInboundMessage
"
Escape message properties tooltip in web console,,30,
Wrap Zookeeper bundle,"ActiveMQ 5.10.0 fails with a class not found error when the zookeeper bundle is deployed as part of the activemq-client feature installation.

The Zookeeper bundle was wrapped in the features.xml in 5.9.1 but this seems to have been lost when the features were split into features-core & features.
",29,"ActiveMQ 5.10.0 fails with a class not found error when the zookeeper bundle is deployed as part of the activemq-client feature installation.

The Zookeeper bundle was wrapped in the features.xml in 5.9.1 but this seems to have been lost when the features were split into features-core & features.
"
https://issues.apache.org/jira/browse/AMQ-4848 - added NetworkConnectors...,"Fixed activemq:list command and it now displays the following output in karaf:

``` javascript
JBossA-MQ:karaf@root> activemq:list



TransportConnectors = {openwire=tcp://localhost:38009?maximumConnections=1000}
BrokerName = amq-broker





TransportConnectors = {openwire=tcp://localhost:61616?maximumConnections=1000}
BrokerName = amq
```
",28,"Fixed activemq:list command and it now displays the following output in karaf:

``` javascript
JBossA-MQ:karaf@root> activemq:list



TransportConnectors = {openwire=tcp://localhost:38009?maximumConnections=1000}
BrokerName = amq-broker





TransportConnectors = {openwire=tcp://localhost:61616?maximumConnections=1000}
BrokerName = amq
```
"
AMQ-5167 ActiveMQ web-cosole fails to start in Karaf - missing import,,27,
AMQ-5167 ActiveMQ web-cosole fails to start in Karaf - missing import,,26,
AMQ-5167 ActiveMQ web-cosole fails to start in Karaf - missing import,,25,
Fixed AMQ-5187 added support for virtual destination subscription recovery,"This patch adds support for applying subscription recovery policy to mapped Queues for virtual destinations. This is a MUST for mapping MQTT retained messages from Virtual/Composite Topics to mapped Queues. 

Since it depends on AMQ-5160, it Includes commits from https://github.com/apache/activemq/pull/22. 
",24,"This patch adds support for applying subscription recovery policy to mapped Queues for virtual destinations. This is a MUST for mapping MQTT retained messages from Virtual/Composite Topics to mapped Queues. 

Since it depends on AMQ-5160, it Includes commits from https://github.com/apache/activemq/pull/22. 
"
Add Jetty host property to resolve URL message,,23,
"Fix for AMQ-5160, resolves retained messages using subscription recovery policy, includes fixes for durable subscription recovery policy, MQTT unsubscribe for QoS != 0","...bscription recovery policy, but fails to resend retained messages for duplicate subscriptions
",22,"...bscription recovery policy, but fails to resend retained messages for duplicate subscriptions
"
"Fix for AMQ-5160, add support for wildcard destination authorization for Retained Messages",,21,
AMQ-4945 : IllegalArgumentException When No Destination Specified On Adm...,"Description of problem:

This is a UI issue.
If I click the 'CREATE' queue button on the screen at '/admin/queues.jsp' it throws an exception, instead of simply putting out a message that a queue destination/name is required.

Jira issue:
https://issues.apache.org/jira/browse/AMQ-4945
",20,"Description of problem:

This is a UI issue.
If I click the 'CREATE' queue button on the screen at '/admin/queues.jsp' it throws an exception, instead of simply putting out a message that a queue destination/name is required.

Jira issue:
https://issues.apache.org/jira/browse/AMQ-4945
"
Added close destroy-method to Postgres data source. ,"Example config crashed and burned on master-slave failover when master lost network connectivity - took down VM.
",19,"Example config crashed and burned on master-slave failover when master lost network connectivity - took down VM.
"
Fix for AMQ-5116.  Deprecated batchStatment and added batchStatement.,"Added deprecation warnings in the log for those using the misspelled
version.  Both versions will set batchStatement for now.
",18,"Added deprecation warnings in the log for those using the misspelled
version.  Both versions will set batchStatement for now.
"
AMQ-5106 fix: unable to build trunk from scratch due to missing dependency (eclipse:eclipse),"This will fix the issue:

https://issues.apache.org/jira/browse/AMQ-5106
",17,"This will fix the issue:

https://issues.apache.org/jira/browse/AMQ-5106
"
Add paging of messages to the webconsole when viewing a deep queue. When queue depth is deep OOM issue occurs,"Fix for the following use:

https://issues.apache.org/jira/browse/AMQ-5024

Currently we have an OOM problem when we browse the queue. I know that the sitemesh was also another problem and was removed by Daniel.  This pagination will make it possible for users to view their JMS messages in queue no matter how deep the queue depth is.
",16,"Fix for the following use:

https://issues.apache.org/jira/browse/AMQ-5024

Currently we have an OOM problem when we browse the queue. I know that the sitemesh was also another problem and was removed by Daniel.  This pagination will make it possible for users to view their JMS messages in queue no matter how deep the queue depth is.
"
AMQ-5033: webconsole url and html encoding missing,,15,
Couple of easy fixes for web console,,14,
[AMQ-5027] Get mvn eclipse:eclipse work for the leveldb stuff,,13,
Remove sitemesh/activemq-all,"Remove the now unused sitemesh jar from the war/assembly.  Also remove the activemq-all jar and use the little jars that are actually needed.
",12,"Remove the now unused sitemesh jar from the war/assembly.  Also remove the activemq-all jar and use the little jars that are actually needed.
"
Changes to support paged web retrieval of messages.,,11,
[AMQ-4994] Remove site-mesh,"This pull request will remove SiteMesh from the war.   This solves the immediate OOM problem by allowing the information to stream directly back to the client without buffering in memory.   Since this removes the filter, this also provides the same benefit to other pages such as if there are 200K queues or similar.

Also, without the buffering and transform, generating the pages is very slightly faster.  
",10,"This pull request will remove SiteMesh from the war.   This solves the immediate OOM problem by allowing the information to stream directly back to the client without buffering in memory.   Since this removes the filter, this also provides the same benefit to other pages such as if there are 200K queues or similar.

Also, without the buffering and transform, generating the pages is very slightly faster.  
"
https://issues.apache.org/jira/browse/AMQ-3452,"```
As well as https://issues.apache.org/jira/browse/AMQ-4509

Add Maven plugin goal to stop the ActiveMQ broker
```
",9,"```
As well as https://issues.apache.org/jira/browse/AMQ-4509

Add Maven plugin goal to stop the ActiveMQ broker
```
"
Add a stop goal to the ActiveMQ Maven plugin.,"Requested by 
https://issues.apache.org/jira/browse/AMQ-3452
and
https://issues.apache.org/jira/browse/AMQ-4509.
",8,"Requested by 
https://issues.apache.org/jira/browse/AMQ-3452
and
https://issues.apache.org/jira/browse/AMQ-4509.
"
Activemq 5.5.1.1,"Branched out of the 5.5.1 tag.

Adds a ""stop"" goal to the ActiveMQ Maven plugin for stopping the broker service on demand, requested by:
https://issues.apache.org/jira/browse/AMQ-3452
https://issues.apache.org/jira/browse/AMQ-4509
",7,"Branched out of the 5.5.1 tag.

Adds a ""stop"" goal to the ActiveMQ Maven plugin for stopping the broker service on demand, requested by:
https://issues.apache.org/jira/browse/AMQ-3452
https://issues.apache.org/jira/browse/AMQ-4509
"
Remove hawt.io console and restore back to just the old console,"This should remove the hawt.io console and put things back to just having the older web console.  Thus, we should be able to get a 5.9.1 shortly.
",6,"This should remove the hawt.io console and put things back to just having the older web console.  Thus, we should be able to get a 5.9.1 shortly.
"
add ClientIdFilterDispatchPolicy,"ClientIdFilterDispatchPolicy dispatches messages in a topic to a given
client. Then the message with a ""PTP_CLIENTID"" property, can be received
by a mqtt client with the same clientId.
",5,"ClientIdFilterDispatchPolicy dispatches messages in a topic to a given
client. Then the message with a ""PTP_CLIENTID"" property, can be received
by a mqtt client with the same clientId.
"
Fix for scala library not resolvable in Servicemix Version.,"Hi, 

with Active MQ 5.9.0 and 5.10-SNAPSHOT I was encountering a problem when I tried to install the activemq-blueprint feature into a Karaf 2.3.3 container. 

The error message was 
Error executing command: URL [mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.scala-library/2.9.1_3] could not be resolved

My container was able to resolve all other bundles from maven central, this was the only one failing. I made the changes in this pull request and the feature was installing fine and I was able to create a broker and use it. 

Best regards
Andreas
",4,"Hi, 

with Active MQ 5.9.0 and 5.10-SNAPSHOT I was encountering a problem when I tried to install the activemq-blueprint feature into a Karaf 2.3.3 container. 

The error message was 
Error executing command: URL [mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.scala-library/2.9.1_3] could not be resolved

My container was able to resolve all other bundles from maven central, this was the only one failing. I made the changes in this pull request and the feature was installing fine and I was able to create a broker and use it. 

Best regards
Andreas
"
fix typo,,3,
AMQ-4414 - Combine windows and unix distros,,2,
Logging broker plugin,"Introduced new flag logSessionEvents for LoggingBrokerPlugin to have more control what to log, because by default logConnectionEvents is generating log also for sessions and its to verbose if you want to monitor only connection events 
",1,"Introduced new flag logSessionEvents for LoggingBrokerPlugin to have more control what to log, because by default logConnectionEvents is generating log also for sessions and its to verbose if you want to monitor only connection events 
"
